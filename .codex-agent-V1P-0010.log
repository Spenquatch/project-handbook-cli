OpenAI Codex v0.93.0 (research preview)
--------
workdir: /Users/spensermcconnell/__Active_Code/project-handbook-cli
model: gpt-5.2
provider: openai
approval: never
sandbox: workspace-write [workdir, /tmp, $TMPDIR]
reasoning effort: high
reasoning summaries: auto
session id: 019c2ad4-44d8-7e00-8b6a-a42938f4a3ff
--------
user
You are a background Coding Agent working on exactly ONE parity task.

Task:
- V1P-0010 — Parity: `make daily` → `ph daily generate`

Relevant checklist subsection (cli_plan/PARITY_CHECKLIST.md):
- Daily (project)
  - [ ] `make daily` → `ph daily generate`
    - Preconditions: none
    - Command: `ph --root <PH_ROOT> daily generate`
    - Outputs to verify: `status/daily/YYYY/MM/DD.md`

Legacy reference repo (source of truth for behavior):
- /Users/spensermcconnell/__Active_Code/oss-saas/project-handbook

Guardrails:
- One task only: V1P-0010.
- Always compare against disposable PH_ROOT(s) (copy legacy repo to temp dir).
- Do NOT run `git checkout`, `git restore`, `git reset`, or similar (it wipes Orchestrator bookkeeping files).
- Do NOT edit `cli_plan/tasks_v1_parity.json` or `cli_plan/session_logs.md` (Orchestrator-owned bookkeeping).

Exact commands to run (use separate disposable roots so outputs don't overwrite):
- LEGACY_SRC="/Users/spensermcconnell/__Active_Code/oss-saas/project-handbook"
- PH_ROOT_LEGACY="$(mktemp -d -t ph-parity-V1P-0010-legacy-XXXXXXXX)"
- PH_ROOT_PH="$(mktemp -d -t ph-parity-V1P-0010-ph-XXXXXXXX)"
- rsync -a --delete --exclude '.git' --exclude 'node_modules' --exclude '.venv' --exclude '.project-handbook' "$LEGACY_SRC/" "$PH_ROOT_LEGACY/"
- rsync -a --delete --exclude '.git' --exclude 'node_modules' --exclude '.venv' --exclude '.project-handbook' "$LEGACY_SRC/" "$PH_ROOT_PH/"
- (cd "$PH_ROOT_LEGACY" && pnpm install --frozen-lockfile)
- (cd "$PH_ROOT_PH" && pnpm install --frozen-lockfile)

# Legacy run (capture stdout and output file)
- (cd "$PH_ROOT_LEGACY" && pnpm make -- daily) > /tmp/legacy-daily-stdout.txt
- LEGACY_DAILY_FILE=$(ls -1 "$PH_ROOT_LEGACY"/status/daily/*/*/*.md | sort | tail -n 1)
- cp "$LEGACY_DAILY_FILE" /tmp/legacy-daily.md

# ph run (capture stdout and output file)
- uv run ph --root "$PH_ROOT_PH" daily generate > /tmp/ph-daily-stdout.txt
- PH_DAILY_FILE=$(ls -1 "$PH_ROOT_PH"/status/daily/*/*/*.md | sort | tail -n 1)
- cp "$PH_DAILY_FILE" /tmp/ph-daily.md

# Compare stdout and file outputs
- diff -u /tmp/legacy-daily-stdout.txt /tmp/ph-daily-stdout.txt
- diff -u /tmp/legacy-daily.md /tmp/ph-daily.md

Acceptance criteria:
- stdout matches legacy byte-for-byte (unless legacy prints non-deterministic paths/timestamps; if so, match exactly).
- generated daily file content matches legacy byte-for-byte.
- Add/adjust deterministic pytest tests to lock parity. (If legacy uses wall-clock date, freeze deterministically in tests.)
- Run `uv run ruff check .` and `uv run pytest -q`.
- Final step: attempt to commit with message `Parity: V1P-0010 daily generate`. If the environment prevents committing, report it clearly.

Reporting back:
- commands executed (exact)
- files changed (exact)
- verification evidence (diff results + ruff/pytest)
- commit hash created (or exact reason commit blocked)
- follow-ups/drift

Completion sentinel (MUST):
- Print exactly one line at end: `DONE: V1P-0010 — <short summary>`
- Optionally: `touch ph-parity-V1P-0010.done`

Notes:
- Do not commit generated logs like `.codex-agent-V1P-0010.*`.
mcp: deepwiki starting
mcp: playwright starting
mcp: google-docs-mcp starting
mcp: google-docs-mcp ready
mcp: playwright ready
mcp: deepwiki ready
mcp startup: ready: google-docs-mcp, playwright, deepwiki

thinking
**Planning for AGENTS.md compliance**

I need to ensure I’m following any AGENTS.md files in the subdirectories related to the files I'm working with. It seems like I need to search for these files first. Okay, so let's make a plan to do that and use the tool designed for updating our plan. I want to make sure everything stays compliant without missing any crucial details as I move forward!
Plan update
Execute the required legacy vs ph commands in disposable roots, diff outputs, then adjust implementation and add deterministic tests until byte-for-byte parity is achieved.
  → Run legacy daily in temp root
  • Run ph daily generate in temp root
  • Diff stdout and generated file
  • Implement CLI parity fixes
  • Add deterministic pytest coverage
  • Run ruff and pytest
  • Commit changes
exec
/bin/zsh -lc 'set -euo pipefail
LEGACY_SRC="/Users/spensermcconnell/__Active_Code/oss-saas/project-handbook"
PH_ROOT_LEGACY="$(mktemp -d -t ph-parity-V1P-0010-legacy-XXXXXXXX)"
PH_ROOT_PH="$(mktemp -d -t ph-parity-V1P-0010-ph-XXXXXXXX)"
echo "PH_ROOT_LEGACY=$PH_ROOT_LEGACY"
echo "PH_ROOT_PH=$PH_ROOT_PH"
rsync -a --delete --exclude '"'.git' --exclude 'node_modules' --exclude '.venv' --exclude '.project-handbook' \""'$LEGACY_SRC/" "$PH_ROOT_LEGACY/"
rsync -a --delete --exclude '"'.git' --exclude 'node_modules' --exclude '.venv' --exclude '.project-handbook' \""'$LEGACY_SRC/" "$PH_ROOT_PH/"
(cd "$PH_ROOT_LEGACY" && pnpm install --frozen-lockfile)
(cd "$PH_ROOT_PH" && pnpm install --frozen-lockfile)

echo "DONE_SETUP"' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 2.16s:
PH_ROOT_LEGACY=/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht
PH_ROOT_PH=/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI
Already up to date

Done in 170ms using pnpm v10.11.1
Already up to date

Done in 157ms using pnpm v10.11.1
DONE_SETUP
Plan update
  → Run legacy daily in temp root
  • Run ph daily generate in temp root
  • Diff stdout and generated file
  • Implement CLI parity fixes
  • Add deterministic pytest coverage
  • Run ruff and pytest
  • Commit changes
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_LEGACY="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht"
PH_ROOT_PH="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI"

# Legacy run (capture stdout and output file)
(cd "$PH_ROOT_LEGACY" && pnpm make -- daily) > /tmp/legacy-daily-stdout.txt
LEGACY_DAILY_FILE=$(ls -1 "$PH_ROOT_LEGACY"/status/daily/*/*/*.md | sort | tail -n 1)
echo "LEGACY_DAILY_FILE=$LEGACY_DAILY_FILE"
cp "$LEGACY_DAILY_FILE" /tmp/legacy-daily.md

# ph run (capture stdout and output file)
uv run ph --root "$PH_ROOT_PH" daily generate > /tmp/ph-daily-stdout.txt
PH_DAILY_FILE=$(ls -1 "$PH_ROOT_PH"/status/daily/*/*/*.md | sort | tail -n 1)
echo "PH_DAILY_FILE=$PH_DAILY_FILE"
cp "$PH_DAILY_FILE" /tmp/ph-daily.md

echo "DONE_RUNS"' in /Users/spensermcconnell/__Active_Code/project-handbook-cli exited 2 in 447ms:
LEGACY_DAILY_FILE=/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/status/daily/2026/02/04.md
error: failed to open file `/Users/spensermcconnell/.cache/uv/sdists-v9/.git`: Operation not permitted (os error 1)
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_PH="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI"

mkdir -p /tmp/uv-cache
export UV_CACHE_DIR=/tmp/uv-cache
export XDG_CACHE_HOME=/tmp

uv run ph --root "$PH_ROOT_PH" daily generate > /tmp/ph-daily-stdout.txt
PH_DAILY_FILE=$(ls -1 "$PH_ROOT_PH"/status/daily/*/*/*.md | sort | tail -n 1)
echo "PH_DAILY_FILE=$PH_DAILY_FILE"
cp "$PH_DAILY_FILE" /tmp/ph-daily.md

echo "DONE_PH"' in /Users/spensermcconnell/__Active_Code/project-handbook-cli exited 2 in 166ms:
handbook_schema_version must be an integer
Remediation: uv tool install project-handbook-cli



thinking
**Troubleshooting tool errors**

I'm running into an error with the ph tool, indicating that `handbook_schema_version` must be an integer. It suggests installing the tool with the command `uv tool install project-handbook-cli`, which makes me wonder if it’s not properly installed. The command `uv run ph` seems to rely on a configuration file located in the root directory, possibly `.project-handbook/config.json`. I’ll have to check if the root contains this configuration or if there's an issue with an environment variable.
thinking
**Examining configuration requirements**

I'm considering whether the error message about `handbook_schema_version` needing to be an integer relates to environment variables from `.env`. The CLI might be expecting this version in a configuration file like `.project-handbook/config.yaml` at the root level. I really need to confirm if the legacy repo has this config file, particularly because we excluded `.project-handbook` in rsync. However, the legacy run succeeded without it. I’ll need to investigate further whether a similar root config file, like `project-handbook.yml`, exists.
thinking
**Searching for configuration version**

I’m planning to open the `PH_ROOT_PH` directory to search for the term "handbook_schema_version." I'll use the `rg` command to help me find any references quickly. This should give me a clearer picture of how the schema version is set and if it’s causing the issues I’ve been encountering. Let’s see what I can uncover in that directory!
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_PH="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI"
rg -n "handbook_schema_version" "$PH_ROOT_PH" || true
ls -la "$PH_ROOT_PH" | sed -n '"'1,120p'
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 288ms:
total 128
drwxr-xr-x@  26 spensermcconnell  staff    832 Feb  4 17:45 .
drwx------@ 809 spensermcconnell  staff  25888 Feb  4 17:45 ..
-rw-r--r--@   1 spensermcconnell  staff    158 Jan 12 10:10 .gitignore
drwxr-xr-x@   3 spensermcconnell  staff     96 Feb  4 17:45 .project-handbook
-rw-r--r--@   1 spensermcconnell  staff   1514 Jan  8 21:34 AGENT.md
-rw-r--r--@   1 spensermcconnell  staff  22978 Jan 23 09:57 Makefile
-rw-r--r--@   1 spensermcconnell  staff   6429 Jan 23 10:07 ONBOARDING.md
-rw-r--r--@   1 spensermcconnell  staff   9677 Jan 23 10:07 README.md
drwxr-xr-x@  35 spensermcconnell  staff   1120 Jan 24 11:05 adr
drwxr-xr-x@   3 spensermcconnell  staff     96 Nov 24 17:04 assets
drwxr-xr-x@   7 spensermcconnell  staff    224 Jan  4 18:20 backlog
drwxr-xr-x@   5 spensermcconnell  staff    160 Jan 11 09:34 contracts
drwxr-xr-x@  10 spensermcconnell  staff    320 Jan 23 10:23 decision-register
drwxr-xr-x@  17 spensermcconnell  staff    544 Nov 24 17:04 docs
drwxr-xr-x@  31 spensermcconnell  staff    992 Jan 19 00:13 features
drwxr-xr-x@   3 spensermcconnell  staff     96 Feb  4 17:45 node_modules
-rw-r--r--@   1 spensermcconnell  staff    285 Dec 22 11:54 package.json
drwxr-xr-x@   7 spensermcconnell  staff    224 Jan 19 08:29 parking-lot
-rw-r--r--@   1 spensermcconnell  staff    114 Feb  4 17:45 pnpm-lock.yaml


thinking
**Investigating directory exclusions**

I'm noticing that the `.project-handbook` directory is present in PH_ROOT_PH, even though I thought it was excluded in rsync. I could be dealing with a legacy repo issue where rsync didn't properly exclude it due to a mismatch in patterns. A possibility is that the directory was created after a certain command, but that doesn't explain why it's there now since I haven't run that command in this specific root. It's puzzling! I'm also realizing that `rg` didn't find `handbook_schema_version`—maybe it’s tucked away in the `.project-handbook/*` directory instead.
thinking
**Searching for hidden configurations**

I'm contemplating the need to search again, maybe even including hidden files this time. I think `rg` doesn't typically include hidden files unless I specifically use the `--hidden` flag, but I wonder if that’s accurate. It's crucial, as the configuration might actually be tucked away in the `.project-handbook`. So, my next step is to try using `rg --hidden` to make sure I cover all bases. Hopefully, this will help me find what I’m looking for!
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_PH="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI"
rg --hidden -n "handbook_schema_version" "$PH_ROOT_PH" || true
rg --hidden -n "schema_version" "$PH_ROOT_PH" || true
ls -la "$PH_ROOT_PH/.project-handbook" || true
find "$PH_ROOT_PH/.project-handbook" -maxdepth 2 -type f -print -exec sed -n '"'1,200p' {} \\; || true
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 152ms:
total 8
drwxr-xr-x@  3 spensermcconnell  staff   96 Feb  4 17:45 .
drwxr-xr-x@ 26 spensermcconnell  staff  832 Feb  4 17:45 ..
-rw-r--r--@  1 spensermcconnell  staff  138 Feb  4 17:45 history.log
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/.project-handbook/history.log
2026-02-04 17:45:22 | ph --root /var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI daily generate

thinking
I'm noticing there isn’t any configuration present. The `.project-handbook/history.log` file was created during my attempt with the ph run, even though it might have failed to execute properly. The error regarding `handbook_schema_version` might be related to the `project_handbook.config.json` file in the root directory. It's only 68 bytes, so I’ll open it to take a closer look and figure out what the issue might be.
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_PH="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI"
cat "$PH_ROOT_PH/project_handbook.config.json"
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 72ms:
{
  "repo_root": "/Users/spensermcconnell/__Active_Code/oss-saas"
}
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_PH="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI"
rg --hidden -n "handbook_schema" "$PH_ROOT_PH" || true
rg --hidden -n "schemaVersion" "$PH_ROOT_PH" || true
rg --hidden -n "schema" "$PH_ROOT_PH/." | head -n 50
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 326ms:
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./process/sessions/templates/decision-alignment-review.md:46:- API contracts (routes/inputs/outputs), GraphQL schema boundaries, auth headers
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./process/sessions/templates/sprint-planning-continued.md:78:- Specs/contracts that must exist before implementation (schemas, APIs, composition configs).
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./process/sessions/templates/sprint-planning-continued.md:97:   - New service under `v2/services/context/` with DB schema for workspaces/references and metadata.
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./process/sessions/templates/sprint-planning-continued.md:170:- Include: endpoints/schema, examples, error cases, and “who owns this contract”.
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./process/sessions/templates/sprint-planning-continued.md:174:- `project-handbook/contracts/` for durable API/schema contracts.
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./process/sessions/templates/sprint-planning-continued.md:187:  - Context subgraph schema (Workspace/Reference/Document/ChatSession types)
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./process/sessions/templates/endpoint-contract-update.md:21:   - Response schema (happy/error)
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0022-v2-capability-manifests-and-toggles.md:44:- Requires careful migration/versioning of capability manifest schema as capabilities grow.
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0022-v2-capability-manifests-and-toggles.md:49:- Enabling triggers provisioning; disabling triggers stub gating without changing composed schema.
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0021-v2-schema-harvester-service.md:7:tags: [tribuence-mini, v2, schema, harvester, cosmo, federation]
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0021-v2-schema-harvester-service.md:9:  - ../features/v2_schema-harvester-service/overview.md
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0021-v2-schema-harvester-service.md:10:  - ../adr/0015-tribuence-mini-v2-cosmo-minio-and-schema-publishing.md
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0021-v2-schema-harvester-service.md:15:As capability count grows, schema publishing must be automated, repeatable, and traceable. Manual introspection and hand
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0021-v2-schema-harvester-service.md:20:## 1) Add a dedicated schema harvester service
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0021-v2-schema-harvester-service.md:24:- publishing subgraph schemas to Cosmo,
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0021-v2-schema-harvester-service.md:27:## 2) Harvester maintains an in-repo mirror of published schemas
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0021-v2-schema-harvester-service.md:29:After successful publish, the harvester writes updated SDL snapshots into the repository under `v2/infra/compose/graphql/subgraphs/*/schema.graphql`
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0021-v2-schema-harvester-service.md:39:- Deterministic schema pipeline across many capabilities.
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0021-v2-schema-harvester-service.md:49:- Composition checks run as part of publish and block invalid schema changes.
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/./adr/0020-v2-rest-wrapper-patterns.md:42:- facade subgraphs for durable capability schemas,
exec
/bin/zsh -lc 'set -euo pipefail
rg -n "handbook_schema_version" . || true
rg -n "must be an integer" . || true
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 101ms:
./src/ph/doctor.py:31:        lines.append(f"handbook_schema_version: {config_check.config.handbook_schema_version}")
./src/ph/doctor.py:34:        lines.append("handbook_schema_version: (unavailable)")
./src/ph/init_repo.py:598:        "handbook_schema_version": DEFAULT_SCHEMA_VERSION,
./tests/test_end_session_session_end_artifacts.py:12:        '{\n  "handbook_schema_version": 1,\n  "requires_ph_version": ">=0.1.0,<0.2.0",\n  "repo_root": "."\n}\n',
./src/ph/config.py:14:    handbook_schema_version: int
./src/ph/config.py:49:    handbook_schema_version = raw.get("handbook_schema_version")
./src/ph/config.py:53:    if not isinstance(handbook_schema_version, int):
./src/ph/config.py:54:        raise ConfigError(_config_error_message("handbook_schema_version must be an integer"))
./src/ph/config.py:61:        handbook_schema_version=handbook_schema_version,
./src/ph/config.py:68:    if config.handbook_schema_version != 1:
./src/ph/config.py:70:            _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
./tests/test_release_activate_clear_show_progress.py:12:        '{\n  "handbook_schema_version": 1,\n  "requires_ph_version": ">=0.1.0,<0.2.0",\n  "repo_root": "."\n}\n',
./tests/test_release_plan.py:12:        '{\n  "handbook_schema_version": 1,\n  "requires_ph_version": ">=0.1.0,<0.2.0",\n  "repo_root": "."\n}\n',
./tests/test_onboarding.py:11:        '{\n  "handbook_schema_version": 1,\n  "requires_ph_version": ">=0.1.0,<0.2.0",\n  "repo_root": "."\n}\n',
./tests/test_release_close.py:12:        '{\n  "handbook_schema_version": 1,\n  "requires_ph_version": ">=0.1.0,<0.2.0",\n  "repo_root": "."\n}\n',
./tests/test_reset.py:13:        '{\n  "handbook_schema_version": 1,\n  "requires_ph_version": ">=0.1.0,<0.2.0",\n  "repo_root": "."\n}\n',
./tests/test_sprint_plan_open.py:12:        '{\n  "handbook_schema_version": 1,\n  "requires_ph_version": ">=0.1.0,<0.2.0",\n  "repo_root": "."\n}\n',
./tests/test_feature_archive.py:15:        '{\n  "handbook_schema_version": 1,\n  "requires_ph_version": ">=0.1.0,<0.2.0",\n  "repo_root": "."\n}\n',
./tests/test_validate.py:11:        '{\n  "handbook_schema_version": 1,\n  "requires_ph_version": ">=0.1.0,<0.2.0",\n  "repo_root": "."\n}\n',
./cli_plan/project_handbook.config.json:2:  "handbook_schema_version": 1,


thinking
**Evaluating configuration setup**

I'm considering whether `project_handbook.config.json` should be in the legacy repo. It seems like I can create a proper config file in PH_ROOT_PH before running ph. However, the instructions are a bit unclear, and the acceptance criteria state that stdout must match the legacy exactly. If we create a config file, output might differ.  

I think I need to allow missing required keys in the CLI config loader to default them but worry this could mask misconfigurations.
thinking
**Considering schema version handling**

I'm thinking about using a heuristic for when a file contains only `repo_root`, making it likely created by older tools. In that case, I could treat it as a v0 marker and infer it corresponds to schema version 1. That seems reasonable, but the contract states the file must include specific fields.

I wonder if we could treat missing fields as defaults and print a doctor. Still, that might conflict with existing rules. Perhaps our config reader should also accept "1" as a string for `handbook_schema_version`, but the error insists it must be an integer, which complicates things. If `None` appears, maybe I can use `DEFAULT_SCHEMA_VERSION` instead?
exec
/bin/zsh -lc "set -euo pipefail
sed -n '1,140p' src/ph/config.py
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 68ms:
from __future__ import annotations

import json
from dataclasses import dataclass
from pathlib import Path

from packaging.specifiers import InvalidSpecifier, SpecifierSet

from . import __version__


@dataclass(frozen=True)
class HandbookConfig:
    handbook_schema_version: int
    requires_ph_version: str
    repo_root: str


@dataclass(frozen=True)
class ConfigCheckResult:

thinking
**Evaluating task configurations**

The config is missing some fields, which should cause it to fail. However, since parity tasks indicate no preconditions, we might need `ph daily generate` to run without a config marker. There are other tasks that could also be affected, but I'll focus on this one for now. It seems wise to allow a `--root` option to bypass the config requirement. But I need to ensure that this change doesn't break existing tests, especially since `test_daily.py` expects the config to be present.
exec
/bin/zsh -lc "set -euo pipefail
sed -n '1,200p' tests/test_daily.py
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 72ms:
from __future__ import annotations

import os
import subprocess
from pathlib import Path


def _write_minimal_ph_root(ph_root: Path) -> None:
    config = ph_root / "project_handbook.config.json"
    config.parent.mkdir(parents=True, exist_ok=True)
    config.write_text(
        '{\n  "handbook_schema_version": 1,\n  "requires_ph_version": ">=0.1.0,<0.2.0",\n  "repo_root": "."\n}\n',
        encoding="utf-8",
    )

    (ph_root / "process" / "checks").mkdir(parents=True, exist_ok=True)
    (ph_root / "process" / "automation").mkdir(parents=True, exist_ok=True)
    (ph_root / "process" / "sessions" / "templates").mkdir(parents=True, exist_ok=True)

    (ph_root / "process" / "checks" / "validation_rules.json").write_text("{}", encoding="utf-8")
exec
/bin/zsh -lc "set -euo pipefail
rg -n \"project_handbook\\.config\\.json\" src/ph | head -n 50
rg -n \"load_handbook_config\\(\" -S src/ph | head -n 50
rg -n \"check_handbook_config\\(\" -S src/ph | head -n 50
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 92ms:
src/ph/doctor.py:46:        lines.append("- MISSING project_handbook.config.json")
src/ph/doctor.py:47:        missing.append(str((ph_root / "project_handbook.config.json").resolve()))
src/ph/root.py:6:    Path("project_handbook.config.json"),
src/ph/root.py:7:    Path("cli_plan/project_handbook.config.json"),  # legacy (deprecated)
src/ph/init_repo.py:472:    config_path = target_root / "project_handbook.config.json"
src/ph/init_repo.py:594:        print("Already exists: project_handbook.config.json")
src/ph/init_repo.py:607:    print("Created: project_handbook.config.json")
src/ph/config.py:31:        ph_root / "project_handbook.config.json",
src/ph/config.py:32:        ph_root / "cli_plan" / "project_handbook.config.json",  # legacy
src/ph/cli.py:529:        config = load_handbook_config(ph_root)
src/ph/config.py:29:def load_handbook_config(ph_root: Path) -> HandbookConfig:
src/ph/config.py:94:        config = load_handbook_config(ph_root)
src/ph/doctor.py:29:    config_check: ConfigCheckResult = check_handbook_config(ph_root)
src/ph/config.py:92:def check_handbook_config(ph_root: Path) -> ConfigCheckResult:
exec
/bin/zsh -lc "set -euo pipefail
sed -n '1,140p' src/ph/root.py
sed -n '480,620p' src/ph/cli.py
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 71ms:
from __future__ import annotations

from pathlib import Path

ROOT_MARKER_RELATIVE_PATHS: tuple[Path, ...] = (
    Path("project_handbook.config.json"),
    Path("cli_plan/project_handbook.config.json"),  # legacy (deprecated)
)


class RootResolutionError(RuntimeError):
    pass


def resolve_ph_root(*, override: str | None, cwd: Path | None = None) -> Path:
    """
    Resolve the Project Handbook repo root (PH_ROOT) by locating the root marker.
    """

    if override is not None:
exec
/bin/zsh -lc "set -euo pipefail
rg -n \"repo_root\" src/ph | head -n 80
rg -n \"class Context\" -S src/ph | head -n 80
rg -n \"build_context\\(\" -S src/ph | head -n 80
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 92ms:
src/ph/migrate_system_scope.py:305:    repo_roots = [
src/ph/migrate_system_scope.py:322:    for root_name in repo_roots:
src/ph/init_repo.py:600:        "repo_root": DEFAULT_REPO_ROOT,
src/ph/rollout_parser.py:69:        repo_root: Path,
src/ph/rollout_parser.py:79:            "repo_root": str(repo_root),
src/ph/rollout_parser.py:97:    def __init__(self, repo_root: Path):
src/ph/rollout_parser.py:98:        self.repo_root = repo_root
src/ph/config.py:16:    repo_root: str
src/ph/config.py:51:    repo_root = raw.get("repo_root")
src/ph/config.py:57:    if not isinstance(repo_root, str) or not repo_root.strip():
src/ph/config.py:58:        raise ConfigError(_config_error_message("repo_root must be a non-empty string"))
src/ph/config.py:63:        repo_root=repo_root,
src/ph/config.py:72:    if config.repo_root != ".":
src/ph/config.py:73:        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
src/ph/context.py:13:class Context:
src/ph/reset_smoke.py:35:    system_ctx = build_context(ph_root=ph_root, scope="system")
src/ph/cli.py:532:        ctx = build_context(ph_root=ph_root, scope=scope)
src/ph/context.py:31:def build_context(*, ph_root: Path, scope: str) -> Context:
exec
/bin/zsh -lc "set -euo pipefail
sed -n '1,120p' src/ph/context.py
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 69ms:
from __future__ import annotations

import os
from dataclasses import dataclass
from pathlib import Path


class ScopeError(RuntimeError):
    pass


@dataclass(frozen=True)
class Context:
    ph_root: Path
    scope: str
    ph_data_root: Path


def resolve_scope(*, cli_scope: str | None) -> str:
    if cli_scope is not None:





thinking
**Examining config usage**

I'm realizing that the config isn’t really needed beyond the validation gate. So, it makes sense to skip loading or validating it for the daily generation. However, other commands might still need the root marker. It seems like the `--root` override could fail if there's no marker file, yet we might consider allowing it to accept a path directly instead. That could ease things for tasks where no specific preconditions are required. I'll need to review parity instructions further to clarify this.
thinking
**Adjusting config validation**

In our temporary root, the marker does exist (project_handbook.config.json), meaning the preconditions are satisfied. However, the config file is shaped differently, so the main fix is to accept its content as valid. This might assist with the root resolution, which currently checks for marker file existence. I'll adjust the validation to treat this legacy config as a "legacy marker only" and allow it to bypass strict validation. But I need to be careful not to enable running on a non-initialized repository.
thinking
**Updating handbook configuration**

I think it would be best to update `load_handbook_config` to support the legacy format. I can accept raw input with just the `repo_root` key and return a config with schema_version 1 and a default `repo_root` of "." for validation gating. Alternatively, I might consider accepting an absolute `repo_root` while still returning ".". However, that could lead to misleading output in the `doctor` command, which checks the configuration. To address this, I could relax the validation to accept any `repo_root`, but that would make it more permissive. It’s a trade-off I need to examine carefully.
thinking
**Analyzing config usage**

It seems the context building doesn’t use the config, but I wonder if `migrate_system_scope` might call `load_handbook_config`. After searching, it turns out it doesn’t, and the config isn't used elsewhere, so I can relax the `repo_root` requirement without issue. I should adjust `validate_handbook_config` to enforce the schema_version and required version only when they’re present. The simplest path could be treating config files with an absolute `repo_root` as valid, but checking if it’s either "." or absolute. I'm thinking we could still allow for different types of `repo_root` for flexibility.
thinking
**Evaluating config contract and legacy support**

The CLI contract specifies `repo_root "."`, which might be outdated. It seems the legacy repo's `repo_root` points to a parent monorepo, while our project-handbook is a subdirectory. To support legacies, I propose allowing absolute `repo_root` values. Since tests expect a valid format, I’ll need to adjust them. We might allow commands like daily generate to skip config validation by building the context without it. Plus, I want to ensure robust loading that accommodates both full and legacy configurations without breaking existing tests. I’ll need to focus on producing outputs that match legacy file content exactly.
exec
/bin/zsh -lc "set -euo pipefail
wc -c /tmp/legacy-daily-stdout.txt /tmp/legacy-daily.md || true
printf \"\\n--- legacy stdout ---\\n\"; cat /tmp/legacy-daily-stdout.txt
printf \"\\n--- legacy daily file ---\\n\"; cat /tmp/legacy-daily.md
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 74ms:
     303 /tmp/legacy-daily-stdout.txt
     749 /tmp/legacy-daily.md
    1052 total

--- legacy stdout ---

> project-handbook@0.0.0 make /private/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht
> make -- daily

Created daily status: /private/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/status/daily/2026/02/04.md

--- legacy daily file ---
---
title: Daily Status - 2026-02-04
type: status-daily
date: 2026-02-04
sprint: SPRINT-SEQ-0004
tags: [status, daily]
links: [../../../sprints/current.md]
---

thinking
**Investigating CLI output**

I'm looking into the legacy stdout, which includes a preamble that seems to be structured like "pnpm make" output along with a final line that shows the path. There’s a function, `_format_pnpm_make_preamble`, that checks the help command and might be relevant for other commands that want to mimic pnpm output. I need to check the daily command handler next and see where "daily generate" is referenced in `cli.py`.
exec
/bin/zsh -lc 'set -euo pipefail
rg -n "daily" src/ph/cli.py | head -n 120
rg -n "Created daily status" -S src/ph | head -n 50
rg -n "format_pnpm_make_preamble" -S src/ph/cli.py
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 94ms:
21:from .daily import check_status as check_daily_status
22:from .daily import create_daily_status
450:    daily_parser = subparsers.add_parser("daily", help="Manage daily status cadence", parents=[sub_common])
451:    daily_subparsers = daily_parser.add_subparsers(dest="daily_command")
452:    daily_generate = daily_subparsers.add_parser("generate", help="Generate daily status", parents=[sub_common])
453:    daily_generate.add_argument("--force", action="store_true", help="Generate even on weekends or overwrite")
454:    daily_check = daily_subparsers.add_parser("check", help="Check daily status freshness", parents=[sub_common])
455:    daily_check.add_argument("--verbose", action="store_true", help="Verbose output")
967:            elif args.command == "daily":
968:                if args.daily_command is None:
969:                    print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
971:                elif args.daily_command == "generate":
972:                    created = create_daily_status(
979:                elif args.daily_command == "check":
980:                    exit_code = check_daily_status(
987:                    print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
src/ph/daily.py:282:    print(f"Created daily status: {paths.status_file}")
75:def _format_pnpm_make_preamble(*, ph_root: Path, make_args: list[str]) -> str:
557:                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=make_args))
exec
/bin/zsh -lc "set -euo pipefail
sed -n '920,1010p' src/ph/cli.py
sed -n '1,120p' src/ph/cli.py
sed -n '240,340p' src/ph/daily.py
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 70ms:
                        release=str(getattr(args, "release")),
                        feature=str(getattr(args, "feature")),
                        epic=bool(getattr(args, "epic", False)),
                        critical=bool(getattr(args, "critical", False)),
                    )
                elif args.release_command == "suggest":
                    exit_code = run_release_suggest(ctx=ctx, version=str(getattr(args, "version")))
                elif args.release_command == "close":
                    exit_code = run_release_close(ctx=ctx, version=str(getattr(args, "version")), env=os.environ)
                else:
                    print(
                        "Usage: ph release <plan|activate|clear|status|show|progress|list|add-feature|suggest|close>\n",
                        file=sys.stderr,
                        end="",
                    )
                    exit_code = 2
            elif args.command == "validate":
                exit_code, _out_path, message = run_validate(
                    ph_root=ph_root,
                    ph_data_root=ctx.ph_data_root,


thinking
**Considering command outputs**

I'm looking at how `create_daily_status` prints "Created daily status" while the legacy stdout includes both a `pnpm make preamble` and that line. It seems we want our output to prepend the preamble to match the legacy output. There's a helper function for formatting the `pnpm make` preamble, which we can use for consistency. This preamble needs to show up in our outputs, particularly for tasks like daily generation. I'll need to ensure the cli matches this requirement for parity.
thinking
**Analyzing command output consistency**

I’m wondering if we should prepend the preamble for all commands, but it seems likely we should, especially since the v1 CLI aims to mirror the output of `pnpm make -- <command>`. Many of the tests might already check for this preamble, so I'll look through the tests next. My plan is to search for instances of "> project-handbook" to see if they assert the inclusion of the preamble in their output expectations. This will help clarify if we need to apply this consistency universally.
exec
/bin/zsh -lc 'set -euo pipefail
rg -n "> project-handbook@" tests | head -n 50
rg -n "make --" tests | head -n 50
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 72ms:
tests/test_help_topics.py:26:        f"> project-handbook@0.0.0 make {resolved}\n"
tests/test_help_topics.py:44:        f"> project-handbook@0.0.0 make {resolved}\n"
tests/test_help_topics.py:61:        f"> project-handbook@0.0.0 make {resolved}\n"
tests/test_help_topics.py:79:        f"> project-handbook@0.0.0 make {resolved}\n"
tests/test_help_topics.py:104:        f"> project-handbook@0.0.0 make {resolved}\n"
tests/test_help_topics.py:120:        f"> project-handbook@0.0.0 make {resolved}\n"
tests/test_help_topics.py:134:        f"> project-handbook@0.0.0 make {resolved}\n"
tests/test_help_topics.py:151:        f"> project-handbook@0.0.0 make {resolved}\n"
tests/test_help_topics.py:27:        "> make -- help sprint\n"
tests/test_help_topics.py:45:        "> make -- help task\n"
tests/test_help_topics.py:62:        "> make -- help feature\n"
tests/test_help_topics.py:80:        "> make -- help release\n"
tests/test_help_topics.py:105:        "> make -- help backlog\n"
tests/test_help_topics.py:121:        "> make -- help parking\n"
tests/test_help_topics.py:135:        "> make -- help validation\n"
tests/test_help_topics.py:152:        "> make -- help utilities\n"
exec
/bin/zsh -lc "set -euo pipefail
rg -n \"sprints/current\" -n src/ph/daily.py
rg -n \"SPRINT\" src/ph/daily.py | head -n 80
sed -n '120,260p' src/ph/daily.py
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli exited 1 in 64ms:


thinking
I see that I’m running into an issue where there are no matches, which is causing an exit with code 1. I’ve used `set -e`, which makes the process stop when there's an error. I think I need to add `|| true` to prevent that exit. So, I'll re-run the command and see if that resolves the issue! Let's make sure everything works smoothly this time.
exec
/bin/zsh -lc "set -euo pipefail
rg -n \"sprints\" src/ph/daily.py || true
rg -n \"current\" src/ph/daily.py || true
sed -n '1,220p' src/ph/daily.py
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 65ms:
54:    link = ph_data_root / "sprints" / "current"
81:    candidate = ph_data_root / "sprints" / year / sprint_id
164:    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
53:def _resolve_current_sprint_path(*, ph_data_root: Path) -> Path | None:
54:    link = ph_data_root / "sprints" / "current"
64:def get_current_sprint(*, ph_data_root: Path, env: dict[str, str]) -> str:
65:    path = _resolve_current_sprint_path(ph_data_root=ph_data_root)
71:def _guess_current_sprint_dir(*, ph_data_root: Path, env: dict[str, str]) -> Path | None:
72:    path = _resolve_current_sprint_path(ph_data_root=ph_data_root)
112:    sprint_dir = _guess_current_sprint_dir(ph_data_root=ph_data_root, env=env)
160:    sprint_id = get_current_sprint(ph_data_root=ph_data_root, env=env)
164:    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
199:        template += "- [ ] No tasks currently in progress\n"
242:        template += "- Continue current work\n"
351:        print(f"✅ Daily status is current ({int(hours)} hours old)")
from __future__ import annotations

import datetime as dt
import json
import os
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_LEGACY="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht"
ls -la "$PH_ROOT_LEGACY/sprints" | sed -n '"'1,120p'
ls -la \""'$PH_ROOT_LEGACY/sprints/current.md" || true
ls -la "$PH_ROOT_LEGACY/sprints/current" || true
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 79ms:
total 0
drwxr-xr-x@  6 spensermcconnell  staff  192 Jan 23 10:16 .
drwxr-xr-x@ 26 spensermcconnell  staff  832 Feb  4 17:45 ..
drwxr-xr-x@  2 spensermcconnell  staff   64 Jan 20 16:18 2026
drwxr-xr-x@  3 spensermcconnell  staff   96 Jan 23 10:16 SEQ
drwxr-xr-x@  7 spensermcconnell  staff  224 Jan 20 14:28 archive
lrwxr-xr-x@  1 spensermcconnell  staff   19 Jan 23 10:16 current -> SEQ/SPRINT-SEQ-0004
lrwxr-xr-x@ 1 spensermcconnell  staff  19 Jan 23 10:16 /var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current -> SEQ/SPRINT-SEQ-0004
ls: /var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current.md: No such file or directory

thinking
**Troubleshooting symlink issues**

I see there's a symlink `sprints/current` pointing to a directory, but there's no `current.md`. The legacy daily file links to `../../../sprints/current.md`, which makes me wonder if the `make daily` command uses a different link that should point to that file, yet it's missing. It's possible there's a script that creates `sprints/current.md`, but it's absent. Also, the daily file references this non-existent `current.md`. I need to check if `sprints/current/plan.md` exists instead.
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_LEGACY="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht"
ls -la "$PH_ROOT_LEGACY/sprints/current" | sed -n '"'1,80p'
ls -la \""'$PH_ROOT_LEGACY/sprints/current/plan.md" || true
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 78ms:
lrwxr-xr-x@ 1 spensermcconnell  staff  19 Jan 23 10:16 /var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current -> SEQ/SPRINT-SEQ-0004
-rw-r--r--@ 1 spensermcconnell  staff  4721 Jan 24 14:07 /var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current/plan.md





thinking
**Examining legacy links**

I see there's a plan, but the legacy daily links to `current.md` instead of `plan.md`. We need to replicate the legacy output closely, even if it’s not right. So, for the project scope, I think the link should be `../../../sprints/current.md`. For system scope, should we change tests to `../../../sprints/current/plan.md`? But it seems the daily file links show that the relative path is indeed `../../../sprints/current.md`. So, we should generate the same link and set the target correctly for the sprint plan.
thinking
**Adjusting legacy formatting**

I’m setting things up according to the legacy format. The header in the legacy format shows `# Daily Status - Wednesday, February 04, 2026`, and I noticed there’s a comma after "Wednesday" in that example. My template uses `date.strftime("%A, %B %d, %Y")`, which also includes the comma, so we're good there! But I need to ensure the second line in YAML, "sprint: SPRINT-SEQ-0004", matches perfectly. I'm using `get_current_sprint` to resolve the symlink correctly. It looks like everything checks out!
thinking
**Reviewing Sprint Telemetry**

I see a potential difference in Sprint Telemetry between legacy and my template. Legacy shows total points as 28 done, 28 velocity with 100%. My template calculates from collected tasks, so if the tasks exist in the repo, it should yield the same counts. Legacy files show similar telemetry values. My `collect_sprint_tasks` reads the task files and parses the data, which might align well. I’ll ensure the output for velocity matches as "Velocity: 28/28 (100%)". I plan to compare bullet markers and run a diff against the legacy repo once everything's set up.
thinking
**Setting up stdout preambles**

I realize that stdout needs to include the `pnpm` preamble lines with the `package.json` name, version, and the make arguments as "daily" instead of "daily generate." The legacy command is `make -- daily`, likely calling `node tools/daily...`. I'll need to ensure our `ph daily generate` command mimics the preamble from `make daily`. For the help topics, we should pass `["daily"]` as the necessary arguments. Even though we call it "daily generate," the preamble will display `> make -- daily`, and after that, I’ll include a line saying "Created daily status: ...".
thinking
**Examining stdout formatting and config validation**

I notice that the legacy stdout has a blank line at the start, followed by `> project-handbook...`. Our preamble returns a string starting with a newline, so we need to replicate this by printing the preamble followed by two newlines. When generating the created line, I have to ensure it uses the absolute path starting with `/private/var/folders` instead of just `/var/folders`, as that matches legacy formatting.

For the config validation issue, I’m planning to add `coerce_legacy_config(raw)` in `load_handbook_config`. If certain fields are missing, I could treat the config as legacy and adjust the schema version. There are considerations to ensure tests remain valid, but my priority is to keep things as simple as possible and maintain functionality. I'll also check the relevant test cases to make sure everything aligns!
exec
/bin/zsh -lc "set -euo pipefail
sed -n '1,220p' tests/test_help_topics.py
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 75ms:
from __future__ import annotations

import subprocess
from pathlib import Path


def _write_minimal_ph_root(ph_root: Path) -> None:
    config = ph_root / "project_handbook.config.json"
    config.parent.mkdir(parents=True, exist_ok=True)
    config.write_text(
        '{\n  "handbook_schema_version": "1",\n  "requires_ph_version": ">=0.1.0,<0.2.0",\n  "repo_root": "."\n}\n',
        encoding="utf-8",
    )


def _write_legacy_like_package_json(ph_root: Path) -> None:
    (ph_root / "package.json").write_text(
        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
        encoding="utf-8",
    )

thinking
**Evaluating configuration settings**

I’m focusing on keeping the contract and tests in mind. For `handbook_schema_version`, if it’s an integer, I’ll keep it; if it’s a string of digits, I’ll convert it to an integer. If it’s missing, I’ll treat it as a legacy config and set it to version 1.

For `requires_ph_version`, I’ll set a default range if it’s missing. The same goes for `repo_root`, defaulting to "." if missing. I’m a bit confused about treating absolute paths, but I think I can work through it!
exec
/bin/zsh -lc "set -euo pipefail
sed -n '1,220p' tests/test_config_validation.py
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 71ms:
from __future__ import annotations

import subprocess
from pathlib import Path


def _write_config(ph_root: Path, *, schema: int = 1, requires: str = ">=0.1.0,<0.2.0") -> None:
    marker = ph_root / "project_handbook.config.json"
    marker.parent.mkdir(parents=True, exist_ok=True)
    marker.write_text(
        f'{{\n  "handbook_schema_version": {schema},\n  "requires_ph_version": "{requires}",\n  "repo_root": "."\n}}\n',
        encoding="utf-8",
    )


def test_schema_mismatch_exits_nonzero_with_remediation(tmp_path: Path) -> None:
    _write_config(tmp_path, schema=999)
    result = subprocess.run(["ph", "--root", str(tmp_path)], capture_output=True, text=True)
    assert result.returncode != 0
    assert "uv tool install project-handbook-cli" in result.stderr
exec
/bin/zsh -lc 'set -euo pipefail
rg -n "Invalid repo_root" -S tests src/ph || true
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 89ms:
src/ph/config.py:73:        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))





thinking
**Evaluating repo_root changes**

I’m noticing that repo_root strict isn’t covered by tests, and changing it might not break tests but could violate the intended contract. However, parity could be necessary. I’m considering keeping strict but allowing an override when repo_root isn’t "." and ph_root is within repo_root. Actually, since config repo_root points to the monorepo root, it seems logically correct to accept ph_root under repo_root. So, I’ll implement validation for that!
thinking
**Adjusting repo_root validation**

I see that repo_root is used in cli.py _build_ctx and check_handbook_config, both of which involve ph_root. I think we need to make some adjustments here. Alternatively, in load_handbook_config, we could normalize repo_root to "." if it points to the parent, but I’m concerned about potentially losing information. It might be simpler to remove repo_root enforcement entirely from validate_handbook_config, but we should consider what the contract actually wants regarding checks. I want to align with the desired contract while supporting legacy configurations!
thinking
**Implementing validate_handbook_config**

I think it’s time to outline the validate_handbook_config function. I’ll first check if the handbook schema version is 1; if not, I’ll throw an error. If ph_root is provided and repo_root isn’t ".", I’ll need to ensure repo_root is a valid path that includes ph_root. I also need to consider what happens if repo_root is ".", and whether we should allow other relative paths. Oh, and I should handle the case where the config is missing schema requirements by defaulting the schema version!
thinking
**Adjusting config handling and CLI output**

I’m considering how to handle missing config fields—maybe we treat them as an error for non-legacy cases, but that’s tough to determine. It might be better to treat them as legacy and use defaults. There's the ConfigCheckResult that includes errors, but it’s not utilized now. I think printing a warning might alter stdout, which could affect parity. After fixing the config, I need to adjust the output for the daily generate command too. I’ll make sure to print a preamble in the CLI while creating the file, and I’ll update tests accordingly!
thinking
**Ensuring output parity and updating tests**

I realize that maintaining stdout match is crucial for parity. I should add a test to assert that stdout includes both the preamble and created line path. I’m thinking of using PH_FAKE_TODAY to create a minimal root with package.json, then run the daily generate to compare stdout with the expected path. I also need to update the daily template link to point to `sprints/current.md` instead of `plan.md`. Lastly, I must check content differences, including the backlog impact counts and sections to ensure they align with the legacy output!
exec
/bin/zsh -lc "set -euo pipefail
sed -n '220,420p' src/ph/daily.py
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 66ms:
        p0_count = len([i for i in backlog_data.get("items", []) if i.get("severity") == "P0"])
        p1_count = len([i for i in backlog_data.get("items", []) if i.get("severity") == "P1"])

        if p0_count > 0:
            template += f"- ⚠️  **P0 Issues**: {p0_count} critical issues require immediate attention\n"
        if p1_count > 0:
            template += f"- P1 Issues: {p1_count} high priority for next sprint\n"
        if p0_count == 0 and p1_count == 0:
            template += "- No P0/P1 issues\n"
    else:
        template += "- No backlog items tracked\n"

    template += "- New issues discovered: (Update if any)\n"

    template += "\n## Decisions\n"
    template += "- (Document any technical decisions made today)\n"

    template += "\n## Next Focus\n"
    if tasks["todo"]:
        for task in tasks["todo"][:3]:
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_LEGACY="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht"
ls -la "$PH_ROOT_LEGACY/backlog/index.json" || true
python - <<'"'PY'
import json, pathlib
p=pathlib.Path(\"/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/backlog/index.json\")
print('exists',p.exists())
if p.exists():
  data=json.loads(p.read_text())
  items=data.get('items',[])
  p0=sum(1 for i in items if i.get('severity')=='P0')
  p1=sum(1 for i in items if i.get('severity')=='P1')
  print('p0',p0,'p1',p1,'total',len(items))
PY
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 175ms:
-rw-r--r--@ 1 spensermcconnell  staff  11203 Jan 23 15:44 /var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/backlog/index.json
exists True
p0 0 p1 2 total 24


thinking
**Ensuring report consistency**

I'm confirming that I need to print the P1 line with the exact same string, including spaces. It should say f"- P1 Issues: {p1_count} high priority for next sprint\n". The legacy example is "- P1 Issues: 2 high priority for next sprint", so I'm on track there. Next, the new issues line should also match the template's requirement. The script needs to ensure that if tasks are present, it still defaults to "Continue current work," replicating legacy behavior. I'm sort of feeling like it might be safe to stick with that approach.
thinking
**Analyzing sprint telemetry**

I'm looking at the legacy sprint telemetry, which shows total points of 28, with all tasks completed and none in progress. My template needs to calculate total points based on task statuses, including to-dos and reviews. If tasks are finished, then total points matches completed points, which is 28 here. However, I need to ensure it captures all statuses properly, just like the legacy system. The Next Focus section defaults to "Continue current work," even with to-do tasks. I should inspect the current sprint tasks in `PH_ROOT_LEGACY/sprints/current/tasks` to clarify.
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_LEGACY="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht"
TASK_DIR="$PH_ROOT_LEGACY/sprints/current/tasks"
ls -la "$TASK_DIR" | sed -n '"'1,120p'
find \""'$TASK_DIR" -maxdepth 2 -name task.yaml -print | head -n 20
python - <<'"'PY'
import pathlib
import re
root=pathlib.Path(\"/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current/tasks\")
statuses={}
points_total=0
points_done=0
points_doing=0
for task_yaml in root.glob('*/task.yaml'):
  text=task_yaml.read_text()
  status=None
  points=0
  tid=None
  title=None
  for line in text.splitlines():
    if ':' in line and not line.strip().startswith('-'):
      k,v=line.split(':',1)
      k=k.strip(); v=v.strip()
      if k=='status': status=v
      if k=='story_points' and v.isdigit(): points=int(v)
      if k=='id': tid=v
      if k=='title': title=v
  status=status or 'todo'
  statuses.setdefault(status,[]).append((tid,title,points,task_yaml.parent.name))
  points_total += points
  if status=='done': points_done += points
  if status=='doing': points_doing += points

print('statuses', {k:len(v) for k,v in statuses.items()})
print('points total',points_total,'done',points_done,'doing',points_doing)
print('todo sample', statuses.get('todo',[])[:3])
PY
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 158ms:
total 0
drwxr-xr-x@ 12 spensermcconnell  staff  384 Jan 24 15:59 .
drwxr-xr-x@  4 spensermcconnell  staff  128 Jan 23 10:16 ..
drwxr-xr-x@ 10 spensermcconnell  staff  320 Jan 23 10:17 TASK-001-investigate-ci-path-for-v2-launch-gates-evidence-bundle
drwxr-xr-x@ 10 spensermcconnell  staff  320 Jan 23 10:17 TASK-002-gate-v0-6-0-ship-check-v2-functional-demo-gate-re-run-evidence
drwxr-xr-x@ 10 spensermcconnell  staff  320 Jan 23 10:17 TASK-003-handbook-close-p1-work-items-now-delivered
drwxr-xr-x@ 10 spensermcconnell  staff  320 Jan 23 10:17 TASK-004-release-close-v0-6-0-activate-next-release
drwxr-xr-x@ 10 spensermcconnell  staff  320 Jan 24 11:05 TASK-005-implement-ci-friendly-v2-launch-gates-contract
drwxr-xr-x@ 10 spensermcconnell  staff  320 Jan 24 11:05 TASK-006-implement-v2-launch-gates-ci-workflow-skeleton
drwxr-xr-x@ 10 spensermcconnell  staff  320 Jan 24 11:05 TASK-007-implement-publish-v2-launch-gates-evidence-artifacts
drwxr-xr-x@ 10 spensermcconnell  staff  320 Jan 24 11:05 TASK-008-implement-ci-evidence-secret-scan-hard-gate
drwxr-xr-x@ 10 spensermcconnell  staff  320 Jan 24 11:05 TASK-009-gate-first-ci-run-of-v2-launch-gates-with-evidence
drwxr-xr-x@ 10 spensermcconnell  staff  320 Jan 24 15:59 TASK-010-fix-twenty-panel-columns-50-50
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current/tasks/TASK-003-handbook-close-p1-work-items-now-delivered/task.yaml
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current/tasks/TASK-001-investigate-ci-path-for-v2-launch-gates-evidence-bundle/task.yaml
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current/tasks/TASK-002-gate-v0-6-0-ship-check-v2-functional-demo-gate-re-run-evidence/task.yaml
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current/tasks/TASK-009-gate-first-ci-run-of-v2-launch-gates-with-evidence/task.yaml
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current/tasks/TASK-010-fix-twenty-panel-columns-50-50/task.yaml
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current/tasks/TASK-005-implement-ci-friendly-v2-launch-gates-contract/task.yaml
/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/sprints/current/tasks/TASK-006-implement-v2-launch-gates-ci-workflow-skeleton/task.yaml

thinking
**Checking file existence**

I need to verify if the “Daily status” file already exists. If it does, I’ll print “Daily status already exists” and exit with code 1. I must ensure the PH_ROOT_PH copy doesn’t already contain that file. It’s possible that it doesn’t, as the repository is the same baseline, and maybe the status/daily doesn’t include today’s file. I’ll check and list the files to be sure. Let's explore that!
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_PH="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI"
ls -la "$PH_ROOT_PH/status/daily/2026/02" || true
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 63ms:
ls: /var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/status/daily/2026/02: No such file or directory
Plan update
Legacy run completed; ph run is currently blocked by config validation. Next I’ll implement the config + daily output parity fixes, then rerun the required ph command and diff outputs.
  ✓ Run legacy daily in temp root
  → Implement CLI parity fixes
  • Run ph daily generate in temp root
  • Diff stdout and generated file
  • Add deterministic pytest coverage
  • Run ruff and pytest
  • Commit changes

thinking
**Searching for AGENTS.md**

I need to implement changes in the repository and confirm the instructions in AGENTS.md. The user gave directions, but I should locate the actual AGENTS.md file first. I suspect it might be in the root directory, so I'll check the listing there to see if AGENTS.md is present. It sounds like there might be an AGENTS file, but I need to verify that! Let's find out.
exec
/bin/zsh -lc "set -euo pipefail
ls -la | sed -n '1,120p'
find .. -maxdepth 3 -name AGENTS.md -o -name AGENT.md | head -n 50
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 284ms:
total 2376
drwxr-xr-x@ 40 spensermcconnell  staff    1280 Feb  4 17:44 .
drwxr-xr-x  51 spensermcconnell  staff    1632 Feb  4 11:03 ..
-rw-r--r--@  1 spensermcconnell  staff  213076 Feb  4 16:53 .codex-agent-V1P-0006.log
-rw-r--r--@  1 spensermcconnell  staff       6 Feb  4 16:44 .codex-agent-V1P-0006.pid
-rw-r--r--@  1 spensermcconnell  staff  157752 Feb  4 17:03 .codex-agent-V1P-0007.log
-rw-r--r--@  1 spensermcconnell  staff       6 Feb  4 16:57 .codex-agent-V1P-0007.pid
-rw-r--r--@  1 spensermcconnell  staff  233366 Feb  4 17:24 .codex-agent-V1P-0008.log
-rw-r--r--@  1 spensermcconnell  staff       6 Feb  4 17:14 .codex-agent-V1P-0008.pid
-rw-r--r--@  1 spensermcconnell  staff    2406 Feb  4 17:14 .codex-agent-V1P-0008.prompt.txt
-rw-r--r--@  1 spensermcconnell  staff  214855 Feb  4 17:39 .codex-agent-V1P-0009.log
-rw-r--r--@  1 spensermcconnell  staff       6 Feb  4 17:31 .codex-agent-V1P-0009.pid
-rw-r--r--@  1 spensermcconnell  staff    2247 Feb  4 17:31 .codex-agent-V1P-0009.prompt.txt
-rw-r--r--@  1 spensermcconnell  staff   60359 Feb  4 17:51 .codex-agent-V1P-0010.log
-rw-r--r--@  1 spensermcconnell  staff       6 Feb  4 17:44 .codex-agent-V1P-0010.pid
-rw-r--r--@  1 spensermcconnell  staff    3122 Feb  4 17:44 .codex-agent-V1P-0010.prompt.txt
drwxr-xr-x@ 12 spensermcconnell  staff     384 Feb  4 17:43 .git
drwxr-xr-x@  3 spensermcconnell  staff      96 Jan 14 17:59 .github
-rw-r--r--@  1 spensermcconnell  staff     126 Feb  4 12:18 .gitignore
drwxr-xr-x@  6 spensermcconnell  staff     192 Jan 14 10:00 .pytest_cache
exec
/bin/zsh -lc "set -euo pipefail
find . -name 'AGENTS.md' -o -name 'AGENT.md'
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 153ms:
./legacy-reference/project-handbook/AGENT.md





thinking
**Validating repo_root path**

I'm planning to implement a validation for the `repo_root` which should accept both absolute paths and "." to better align with the configuration. My approach is to keep `repo_root` as a raw value and ensure that if it equals ".", it’s okay. If the path is absolute, I’ll also accept it. It seems sensible to allow any non-empty string and remove the error check to avoid complications while ensuring the path is valid for our needs.
thinking
**Adjusting repo_root validation**

I noticed that the contract in the documentation mentions ".", but it’s not enforced, which is okay. I’m considering removing the validation check for `repo_root` or altering it to accept both "." and any absolute path. If `repo_root` equals ".", that's fine, but I want to accommodate any input without strict checks. I should also see if `migrate_system_scope` expects this to locate other repos based on the config. I might adjust the validation for full config scenarios too.
thinking
**Adjusting legacy config validation**

For the legacy configuration, I understand that we default those fields, meaning validation would still enforce "." if we don't change anything. I’m considering a special case for when `requires_ph_version` is missing. Instead, I think I’ll add an `is_legacy` field in `load_handbook_config`, but changes in the dataclass might be too extensive. It seems more practical to relax the `repo_root` validation. I’ll remove the check for "." to allow absolute paths and update the template link and tests accordingly.
thinking
**Updating tests for daily parity**

I'm planning to add a new test for daily parity, focusing on both stdout and file generation. The acceptance criteria suggest we need deterministic pytest tests for consistency, possibly freezing the wall-clock date if required. I'll assert that the output matches expectations in a controlled environment, but full legacy repo comparison might be too much. Instead, I'll mimic the output from the daily generator with a minimal setup using `tmp_path`, ensuring the template structure aligns with legacy requirements without including ongoing tasks. This will help us achieve the necessary byte-for-byte match during tests.
thinking
**Exploring legacy reference for tests**

I’m considering creating an integration test that would run the daily generation by using a fixture built from copying the legacy reference repo. However, that might be quite large. I noticed there’s a `legacy-reference/project-handbook` that could be useful for parity tests. I’ll check the `legacy-reference` folder in this repo to see if it includes a subset of the legacy repo. It would be helpful to list its contents to see if it contains what we need for our tests.
exec
/bin/zsh -lc "set -euo pipefail
ls -la legacy-reference | sed -n '1,120p'
ls -la legacy-reference/project-handbook | sed -n '1,80p'
" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 78ms:
total 0
drwxr-xr-x@  3 spensermcconnell  staff    96 Jan 17 10:37 .
drwxr-xr-x@ 40 spensermcconnell  staff  1280 Feb  4 17:44 ..
drwxr-xr-x@ 29 spensermcconnell  staff   928 Jan 17 10:07 project-handbook
total 168
drwxr-xr-x@ 29 spensermcconnell  staff    928 Jan 17 10:07 .
drwxr-xr-x@  3 spensermcconnell  staff     96 Jan 17 10:37 ..
-rw-r--r--@  1 spensermcconnell  staff   8196 Jan 17 09:50 .DS_Store
-rw-r--r--@  1 spensermcconnell  staff    164 Jan 16 23:34 .gitignore
drwxr-xr-x@  3 spensermcconnell  staff     96 Jan 16 23:33 .ph
drwxr-xr-x@  5 spensermcconnell  staff    160 Jan 12 13:32 .project-handbook
-rw-r--r--@  1 spensermcconnell  staff   1514 Jan  8 21:34 AGENT.md
-rw-r--r--@  1 spensermcconnell  staff  32709 Jan 12 16:29 Makefile
-rw-r--r--@  1 spensermcconnell  staff   6401 Jan 13 16:32 ONBOARDING.md
-rw-r--r--@  1 spensermcconnell  staff   9497 Jan  9 13:49 README.md
drwxr-xr-x@ 29 spensermcconnell  staff    928 Jan 12 17:22 adr
drwxr-xr-x@  3 spensermcconnell  staff     96 Nov 24 17:04 assets
drwxr-xr-x@  7 spensermcconnell  staff    224 Jan  4 18:20 backlog
drwxr-xr-x@  5 spensermcconnell  staff    160 Jan 11 09:34 contracts
drwxr-xr-x@  8 spensermcconnell  staff    256 Jan 11 20:45 decision-register

thinking
**Reviewing project handbook**

I'm noticing that the `legacy-reference/project-handbook` appears to be a copy of an older repository used for tests, complete with node_modules and other components. There's also a `project_handbook.config.json` that's about 99 bytes, which might contain required keys. I think it would be good to take a closer look at that JSON file to confirm what keys are included and how they might be used. Let's dig into this!
exec
/bin/zsh -lc 'set -euo pipefail
cat legacy-reference/project-handbook/project_handbook.config.json
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 59ms:
{
  "handbook_schema_version": 1,
  "requires_ph_version": ">=0.1.0,<0.2.0",
  "repo_root": "."
}







thinking
**Evaluating legacy config for tests**

The legacy-reference should include the full configuration with the correct fields, while the parity run pulls from a minimal configuration in the oss-saas/project-handbook. I think using the legacy-reference folder for daily generate testing and comparing to expected output makes sense, though I need to ensure validity. The repo has existing tests for daily generation but not for stdout or full file content. So, we'll add deterministic pytest tests for the legacy config handling in `tests/test_daily.py`. We need to consider validation checks too!
thinking
**Preparing tests for legacy config**

The parity run needs the actual sprint ID from the repository, so I need to create a symlink and relevant tasks. The CLI root resolution also requires a marker file, which is the config file we already create, so that's good. I want to make sure the config loader can handle missing schemas and still return defaults without errors. I’ll create a new test file called `tests/test_config_legacy_shape.py` to verify that running `ph --root tmp_path daily generate` functions properly with only the repo_root defined. Plus, the tests should assert that the stdout matches the expected output as per legacy requirements. I think I’ll use `project_handbook.config.json` with either `{"repo_root": "/tmp"}` or `{"repo_root": "."}`, since the legacy configuration uses absolute paths.
thinking
**Setting up testing environment**

I plan to include absolute paths for thorough test coverage. I'll create a `package.json` with the project name as "project-handbook" and version "0.0.0" to match the preamble. The `process/checks/validation_rules.json` could be optional. There'll be a directory for sprints with a symlink to the current sprint, and a backlog with severity items. 

I think I can use the `PH_FAKE_TODAY` environment variable for a set date in the tests to ensure determinism. I'll run `subprocess.run` with the appropriate parameters while using `--no-post-hook` to isolate tests and prevent history logs from affecting my results. We must capture stdout and ensure the generated file content matches expected strings too.
thinking
**Assessing post-command behavior**

In the CLI, after running a command, it invokes `run_post_command_hook`, which might write to the history but not display stdout. To maintain determinism, it seems better to disable this. However, the parity run doesn’t disable it, even though it writes to `.project-handbook/history.log`, which doesn't affect stdout.

I need to ensure that the acceptance criteria are met: stdout must match legacy outputs exactly, with no extra post-hook output. In our tests, I think I'll mimic the parity run without `--no-post-hook`, but I have to be cautious of potential validation error messages that could create mismatches. It seems stdout captured includes only the preamble and created line, indicating post-hook probably doesn’t print on success, or it might be disabled.
thinking
**Implementing test updates and configurations**

In the CLI, the post command hook may run validations and log history but can output information. For determinism, I'll focus on tests without `--no-post-hook`, ensuring history logs are created in `.project-handbook/history.log`.

I'm modifying several files including `config.py` to ensure it handles default schemas and required fields correctly without unnecessary checks. I’ll also adjust `daily.py` to change where the sprint plan resides and update `cli.py` to format the preamble for the daily generate command correctly.

In the tests, I'll ensure everything aligns with legacy outputs, especially for stdout and link references. New tests will validate the full contents match legacy requirements for a specific date and ensure the system scope is correctly configured. This involves creating necessary symlinks, checking task resolutions, and confirming conditions for daily generation.
thinking
**Developing backlog index and output format**

I’m working on creating a backlog index file that reads JSON, counts priority issues, and lists two priority 1 (P1) items. When there are P1 issues, it will print a message about them but won’t mention if there are no high-priority issues. 

Next, I’ll focus on showing the top three to-do tasks, though there won't be any. For sprint telemetry, I need to compute story points from tasks marked as done. My plan is to create 10 tasks totaling 28 points, ensuring the format includes necessary lines like id, title, status, and story points.

The template for the file will follow the legacy format, with proper heading and ensuring it ends with a newline. I’ll make sure the output aligns with the expected legacy stdout, which consists of appropriate preamble sequences and printed lines. I will also verify that my outputs match the formatting of legacy files, checking for necessary blank lines and newlines.
exec
/bin/zsh -lc "python - <<'PY'
from pathlib import Path
p=Path('/tmp/legacy-daily-stdout.txt')
data=p.read_bytes()
print('endswith newline', data.endswith(b'\\n'))
print('repr tail', repr(data[-80:]))
PY" in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 170ms:
endswith newline True
repr tail b'00gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/status/daily/2026/02/04.md\n'
file update
M /Users/spensermcconnell/__Active_Code/project-handbook-cli/src/ph/config.py
@@ -10,2 +10,5 @@
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
@@ -49,3 +52,10 @@
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
@@ -71,4 +81,2 @@
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
apply_patch(auto_approved=true) exited 0 in 25ms:
Success. Updated the following files:
M src/ph/config.py
file update:
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)

file update:
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)


thinking
**Updating configuration settings**

It looks like the config now has a default for missing elements, which is great! I removed the repo_root check too, which simplifies things. Now, I need to focus on modifying the daily link to ensure everything functions correctly. This feels like a step forward, but I want to make sure that all the adjustments are in sync! Let's double-check everything to avoid any issues down the line.
file update
M /Users/spensermcconnell/__Active_Code/project-handbook-cli/src/ph/daily.py
@@ -163,3 +163,3 @@
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
apply_patch(auto_approved=true) exited 0 in 45ms:
Success. Updated the following files:
M src/ph/daily.py
file update:
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()

file update:
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()

file update
M /Users/spensermcconnell/__Active_Code/project-handbook-cli/src/ph/cli.py
@@ -971,2 +971,3 @@
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
apply_patch(auto_approved=true) exited 0 in 60ms:
Success. Updated the following files:
M src/ph/cli.py
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()

file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()

file update
M /Users/spensermcconnell/__Active_Code/project-handbook-cli/tests/test_daily.py
@@ -26,3 +26,3 @@
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
+    target = scope_root / "sprints" / "current.md"
     return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
apply_patch(auto_approved=true) exited 0 in 68ms:
Success. Updated the following files:
M tests/test_daily.py
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..1db2070bad905caa76ffcb34b1c24715ec981c8d
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,7 +24,7 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
+    target = scope_root / "sprints" / "current.md"
     return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
 
 

file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..1db2070bad905caa76ffcb34b1c24715ec981c8d
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,7 +24,7 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
+    target = scope_root / "sprints" / "current.md"
     return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
 
 



thinking
**Considering legacy config tests**

I need to add a test for legacy configuration that only includes repo_root. The default requires_ph_version, which checks that our __version__ falls within a specified range—likely around 0.1.x. I’ll embed expected file content strings to match the legacy format but include sprint information. The output needs to depend on tasks, and we should ensure sprint telemetry reflects the right velocity percentage. Finally, I'll ensure the expected file content matches our current sprint link.
thinking
**Ensuring sprint task parsing**

I need to make sure that `collect_sprint_tasks` parses tasks, including their IDs and titles properly. Currently, the Progress section shows "No tasks currently in progress" since both doing and review lists are empty. The Completed Today section is still a placeholder, and blockers show "- None". It’s important that we match the legacy format. I also need to incorporate a line for P1 issues only if p1_count is greater than 0. Finally, I’ll ensure the tasks directory is created and write a new test, possibly updating old ones too.
file update
A /Users/spensermcconnell/__Active_Code/project-handbook-cli/tests/test_daily_make_parity.py
from __future__ import annotations

import os
import subprocess
from pathlib import Path


def _write_legacy_like_config(ph_root: Path) -> None:
    # Legacy handbook repos may have only repo_root (and it may be absolute).
    (ph_root / "project_handbook.config.json").write_text(
        '{\n  "repo_root": "/tmp"\n}\n',
        encoding="utf-8",
    )


def _write_legacy_like_package_json(ph_root: Path) -> None:
    (ph_root / "package.json").write_text(
        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
        encoding="utf-8",
    )


def _write_sprint_with_done_tasks(ph_root: Path) -> None:
    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
    tasks_dir = sprint_dir / "tasks"
    tasks_dir.mkdir(parents=True, exist_ok=True)

    # 10 done tasks totaling 28 points.
    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
    for i, pts in enumerate(points, start=1):
        task_id = f"TASK-{i:03d}"
        task_dir = tasks_dir / f"{task_id}-example"
        task_dir.mkdir(parents=True, exist_ok=True)
        (task_dir / "task.yaml").write_text(
            "\n".join(
                [
                    f"id: {task_id}",
                    f"title: Example {task_id}",
                    "status: done",
                    f"story_points: {pts}",
                    "",
                ]
            ),
            encoding="utf-8",
        )

    current_link = ph_root / "sprints" / "current"
    current_link.parent.mkdir(parents=True, exist_ok=True)
    current_link.symlink_to(sprint_dir)


def _write_backlog_index(ph_root: Path) -> None:
    backlog = ph_root / "backlog"
    backlog.mkdir(parents=True, exist_ok=True)
    (backlog / "index.json").write_text(
        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
        encoding="utf-8",
    )


def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
    _write_legacy_like_config(tmp_path)
    _write_legacy_like_package_json(tmp_path)
    _write_sprint_with_done_tasks(tmp_path)
    _write_backlog_index(tmp_path)

    env = dict(os.environ)
    env["PH_FAKE_TODAY"] = "2026-02-04"

    result = subprocess.run(
        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
        capture_output=True,
        text=True,
        env=env,
    )
    assert result.returncode == 0

    resolved = tmp_path.resolve()
    expected_stdout = (
        "\n"
        f"> project-handbook@0.0.0 make {resolved}\n"
        "> make -- daily\n"
        "\n"
        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
    )
    assert result.stdout == expected_stdout

    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
    assert out_path.exists()
    assert out_path.read_text(encoding="utf-8") == (
        "---\n"
        "title: Daily Status - 2026-02-04\n"
        "type: status-daily\n"
        "date: 2026-02-04\n"
        "sprint: SPRINT-SEQ-0004\n"
        "tags: [status, daily]\n"
        "links: [../../../sprints/current.md]\n"
        "---\n"
        "\n"
        "# Daily Status - Wednesday, February 04, 2026\n"
        "\n"
        "## Sprint: SPRINT-SEQ-0004\n"
        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
        "\n"
        "## Progress\n"
        "- [ ] No tasks currently in progress\n"
        "\n"
        "## Completed Today\n"
        "- [ ] (Update with completed tasks)\n"
        "\n"
        "## Blockers\n"
        "- None\n"
        "\n"
        "## Backlog Impact\n"
        "- P1 Issues: 2 high priority for next sprint\n"
        "- New issues discovered: (Update if any)\n"
        "\n"
        "## Decisions\n"
        "- (Document any technical decisions made today)\n"
        "\n"
        "## Next Focus\n"
        "- Continue current work\n"
        "\n"
        "## Sprint Telemetry\n"
        "- Total Points: 28\n"
        "- Completed: 28\n"
        "- In Progress: 0\n"
        "- Velocity: 28/28 (100%)\n"
    )

apply_patch(auto_approved=true) exited 0 in 94ms:
Success. Updated the following files:
A tests/test_daily_make_parity.py
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..1db2070bad905caa76ffcb34b1c24715ec981c8d
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,7 +24,7 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
+    target = scope_root / "sprints" / "current.md"
     return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
 
 
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..1db2070bad905caa76ffcb34b1c24715ec981c8d
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,7 +24,7 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
+    target = scope_root / "sprints" / "current.md"
     return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
 
 
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+



thinking
**Ensuring symlink functionality**

I need to confirm that `symlink_to` uses absolute paths. By default, it creates a symlink with the given absolute path, and in my test, `sprint_dir` is absolute within `tmp_path`. This means it should work fine pointing to `sprints/current`. On macOS, it might create a relative link, which could be okay. However, I need to check that `collect_sprint_tasks` properly resolves the symlink and that the required target exists, which it does since we created `sprint_dir`. I'm also double-checking that necessary files, like `project_handbook.config.json`, exist.
thinking
**Finalizing updates and tests**

I've confirmed that the path is built from `ph_data_root / status/daily`, and since `ph_data_root` is resolved as `ph_root`, everything seems to match up great. I might need to update the existing test `_write_minimal_ph_root`—that seems fine. Now I’m considering whether to run formatting, but that's not strictly necessary. I need to implement a CLI parity fix and mark that plan step as complete. After that, I’ll focus on running `ph daily generate` in the temporary root, but first, I should rerun the parity commands to capture stdout and then diff it later after updating the plan.
Plan update
  ✓ Run legacy daily in temp root
  ✓ Implement CLI parity fixes
  → Run ph daily generate in temp root
  • Diff stdout and generated file
  • Add deterministic pytest coverage
  • Run ruff and pytest
  • Commit changes
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..1db2070bad905caa76ffcb34b1c24715ec981c8d
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,7 +24,7 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
+    target = scope_root / "sprints" / "current.md"
     return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
 
 
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+


thinking
**Executing command with cache fix**

I'm about to rerun the command with `uv cache fix`. I'll use the existing temp root for PH_ROOT_PH, and I checked that there's no leftover status/daily file, which is good! So, I’ll run the command to capture stdout in `/tmp/ph-daily-stdout.txt`, ensuring I'm following the exact command while adding env variables for permissions. Sure, it might slightly deviate, but it’s necessary. Let's note everything in the report and ensure the date is correct for today!
exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_PH="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI"

mkdir -p /tmp/uv-cache
export UV_CACHE_DIR=/tmp/uv-cache
export XDG_CACHE_HOME=/tmp

uv run ph --root "$PH_ROOT_PH" daily generate > /tmp/ph-daily-stdout.txt
PH_DAILY_FILE=$(ls -1 "$PH_ROOT_PH"/status/daily/*/*/*.md | sort | tail -n 1)
echo "PH_DAILY_FILE=$PH_DAILY_FILE"
cp "$PH_DAILY_FILE" /tmp/ph-daily.md

echo "DONE_PH_RUN"' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 694ms:
PH_DAILY_FILE=/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/status/daily/2026/02/04.md
DONE_PH_RUN
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..1db2070bad905caa76ffcb34b1c24715ec981c8d
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,7 +24,7 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
+    target = scope_root / "sprints" / "current.md"
     return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
 
 
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+


thinking
**Updating plan steps**

I’m focused on updating my plan to include the next steps. First, I'll run the `ph` command to complete its process, and then I’ll proceed with the diff to compare the stdout and the file. This is a straightforward task, but it requires careful attention to detail to ensure everything lines up properly. I'll make sure to track my progress as I go along.
Plan update
  ✓ Run legacy daily in temp root
  ✓ Implement CLI parity fixes
  ✓ Run ph daily generate in temp root
  → Diff stdout and generated file
  • Add deterministic pytest coverage
  • Run ruff and pytest
  • Commit changes
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..1db2070bad905caa76ffcb34b1c24715ec981c8d
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,7 +24,7 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
+    target = scope_root / "sprints" / "current.md"
     return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
 
 
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

exec
/bin/zsh -lc 'set -euo pipefail
# Compare stdout and file outputs
diff -u /tmp/legacy-daily-stdout.txt /tmp/ph-daily-stdout.txt || true

diff -u /tmp/legacy-daily.md /tmp/ph-daily.md || true

# quick sanity output stats
wc -c /tmp/ph-daily-stdout.txt /tmp/ph-daily.md
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 66ms:
--- /tmp/legacy-daily-stdout.txt	2026-02-04 17:45:14
+++ /tmp/ph-daily-stdout.txt	2026-02-04 17:54:46
@@ -1,5 +1,5 @@
 
-> project-handbook@0.0.0 make /private/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht
+> project-handbook@0.0.0 make /private/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI
 > make -- daily
 
-Created daily status: /private/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/status/daily/2026/02/04.md
+Created daily status: /private/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/status/daily/2026/02/04.md
--- /tmp/legacy-daily.md	2026-02-04 17:45:14
+++ /tmp/ph-daily.md	2026-02-04 17:54:46
@@ -4,7 +4,7 @@
 date: 2026-02-04
 sprint: SPRINT-SEQ-0004
 tags: [status, daily]
-links: [../../../sprints/current.md]
+links: [../../../../sprints/current.md]
 ---
 
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..e4fa269ec6dd4dd4b61128c70b160c9d6008f3ae
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,7 +161,7 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
+    sprint_plan = ph_data_root / "sprints" / "current.md"
     sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
 
     weekday = date.weekday()
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..1db2070bad905caa76ffcb34b1c24715ec981c8d
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,7 +24,7 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
+    target = scope_root / "sprints" / "current.md"
     return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
 
 
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+








thinking
**Evaluating command discrepancies**

I'm encountering some confusion regarding command execution. They mention, "if so, match exactly," which seems contradictory since the guardrails suggest using separate roots. Maybe they expect a comparison to be made after normalization? However, the command `diff -u` seems to indicate it will fail because of raw outputs. I think I need to run the commands in the same root but capture outputs separately to avoid overwriting. That could be a workable solution!
thinking
**Examining output instructions**

The instructions clearly state to use separate disposable roots to prevent overwriting outputs. However, I wonder if it's possible to run the ph command against the legacy root while setting a different output path—though that could lead to issues since it writes to status/daily. It seems like I need to consider matching the stdout and file content while preserving the "shape." But since the acceptance criteria expect byte-for-byte matches, I'm puzzled about how to align the roots without violating the guardrails.
thinking
**Analyzing diff instructions**

There's a contradiction in the instructions: it states to use separate disposable roots to avoid overwriting, but the diff instructions compare outputs in /tmp, which would inherently show different root paths. This could lead to mismatches. I wonder if they expect the root path to consistently be absent in my outputs. To address this, I could adjust the ph output to use relative paths, but that might still lead to mismatches with the legacy command's absolute paths. Perhaps running both commands in the same root while capturing separate outputs could resolve this!
thinking
**Understanding link discrepancies**

I'm considering whether we can ignore the root path differences and treat them as non-deterministic, but acceptance criteria say they need to match exactly. I notice an issue with the links: the legacy link uses `../../../sprints/current.md`, while mine is `../../../../sprints/current.md`, which is incorrect. It seems the relative link calculation is off because the ph command might be using a different daily file location. I double-checked the calculation, and it turns out I went up four levels instead of three.
thinking
**Clarifying link calculations**

It looks like the legacy daily file is indeed in a different directory, and the links seem to have discrepancies. The path to the current link shouldn’t go up four levels; it should only go up three, which suggests that the legacy generator might hardcode the link as `../../../sprints/current.md` regardless of the depth. It seems I need to adjust my generator to replicate this exact link to ensure consistency. So, I’ll set `sprint_plan_rel` to that fixed string for the project scope potentially, while verifying how the legacy behaves with system scope links, too.
thinking
**Analyzing output paths**

It seems like the acceptance criteria expect me to adjust the `ph` command to print paths based on the `--root` argument, which could help avoid confusion about resolved paths. Although they advise using separate disposable roots, I’m wondering if there’s a way to run both commands under the same root without overwriting outputs. Maybe using symlinks could allow me to have paths that match for both commands. Still, this feels tricky, especially since legacy output includes absolute paths, and I need to decide how to handle that appropriately.
thinking
**Examining output differences**

I’m contemplating whether `pnpm make -- daily` in their environment prints relative paths rather than absolute ones, which could affect how we handle the outputs. Given the instructions, it's likely we should treat the differences due to roots as acceptable. However, if legacy prints absolute paths, our outputs should too. We could try running both commands under the same root without overwriting outputs. Ultimately, I’m realizing we might need to modify how paths are printed to align the outputs better while following the rules.
file update
M /Users/spensermcconnell/__Active_Code/project-handbook-cli/src/ph/daily.py
@@ -164,3 +164,5 @@
     sprint_plan = ph_data_root / "sprints" / "current.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
apply_patch(auto_approved=true) exited 0 in 93ms:
Success. Updated the following files:
M src/ph/daily.py
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..1db2070bad905caa76ffcb34b1c24715ec981c8d
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,7 +24,7 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
+    target = scope_root / "sprints" / "current.md"
     return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
 
 
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..1db2070bad905caa76ffcb34b1c24715ec981c8d
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,7 +24,7 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
+    target = scope_root / "sprints" / "current.md"
     return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
 
 
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

file update
M /Users/spensermcconnell/__Active_Code/project-handbook-cli/tests/test_daily.py
@@ -27,3 +27,4 @@
     target = scope_root / "sprints" / "current.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
apply_patch(auto_approved=true) exited 0 in 103ms:
Success. Updated the following files:
M tests/test_daily.py
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

exec
/bin/zsh -lc 'set -euo pipefail
PH_ROOT_PH="/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI"
rm -f "$PH_ROOT_PH/status/daily/2026/02/04.md"

mkdir -p /tmp/uv-cache
export UV_CACHE_DIR=/tmp/uv-cache
export XDG_CACHE_HOME=/tmp

uv run ph --root "$PH_ROOT_PH" daily generate > /tmp/ph-daily-stdout.txt
PH_DAILY_FILE=$(ls -1 "$PH_ROOT_PH"/status/daily/*/*/*.md | sort | tail -n 1)
cp "$PH_DAILY_FILE" /tmp/ph-daily.md

diff -u /tmp/legacy-daily.md /tmp/ph-daily.md || true
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 518ms:

file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+


thinking
**Checking diff output**

I produced a diff, but it seems there was no output since the files are identical. That's good, but I need to check the stdout again, as it might still differ by the root path. I'll make sure to verify this anyway, just to be sure I'm covering all my bases and getting the right results! It's always better to double-check to confirm everything is running smoothly.
exec
/bin/zsh -lc 'set -euo pipefail
diff -u /tmp/legacy-daily-stdout.txt /tmp/ph-daily-stdout.txt || true
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 77ms:
--- /tmp/legacy-daily-stdout.txt	2026-02-04 17:45:14
+++ /tmp/ph-daily-stdout.txt	2026-02-04 17:56:37
@@ -1,5 +1,5 @@
 
-> project-handbook@0.0.0 make /private/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht
+> project-handbook@0.0.0 make /private/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI
 > make -- daily
 
-Created daily status: /private/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-legacy-XXXXXXXX.byLzyTvDht/status/daily/2026/02/04.md
+Created daily status: /private/var/folders/2x/5mqqp02j36v079m96nx8fjs00000gn/T/ph-parity-V1P-0010-ph-XXXXXXXX.ykqDCsCikI/status/daily/2026/02/04.md
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+


thinking
**Updating test plan**

I see now that the file output matches exactly, though the stdout has a different root path, which makes sense due to the separate roots. So, I’ll report that. Next, I need to move on to the plan where the step difference is completed, but I still need to add tests. The item "Add deterministic pytest coverage" is still pending, so I’ll mark it in progress and make sure the tests adequately cover parity. I might need to adjust because of the changes in tests and what’s been added. I'll update the plan accordingly.
Plan update
Daily file content now matches legacy byte-for-byte; stdout only differs by the temp root path (expected since separate PH_ROOTs). Next I’ll ensure pytest coverage reflects the legacy link behavior and stdout preamble.
  ✓ Run legacy daily in temp root
  ✓ Implement CLI parity fixes
  ✓ Run ph daily generate in temp root
  ✓ Diff stdout and generated file
  → Add deterministic pytest coverage
  • Run ruff and pytest
  • Commit changes
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+



thinking
**Ensuring test alignment**

I need to make sure our tests align with the recent updates. We already added a new test, but I should confirm it passes after the changes. I'll run pytest soon, but first, I have to check if any existing tests depend on old links or the configuration validation of repo_root.

I might also consider updating the docs, although it’s not required. Plus, the new configuration defaults could affect tests related to validation. I'll ensure everything is in place before proceeding with the tests, including checking symlink creation in CI.
thinking
**Running tests and checks**

I’ll update things after running ruff and pytest. I think the coverage step might already be done, but I need to double-check. I’ll run ruff check and pytest with the quiet flag to keep things tidy. 

It’s crucial to ensure that the UV cache is utilized properly since those should run within our repo and not require writes to home, but UV might. I'll set the necessary environment variables and execute `uv run ruff check .` and `uv run pytest -q`. I'll also set UV_CACHE_DIR accordingly.
Plan update
  ✓ Run legacy daily in temp root
  ✓ Implement CLI parity fixes
  ✓ Run ph daily generate in temp root
  ✓ Diff stdout and generated file
  ✓ Add deterministic pytest coverage
  → Run ruff and pytest
  • Commit changes
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

exec
/bin/zsh -lc 'set -euo pipefail
mkdir -p /tmp/uv-cache
export UV_CACHE_DIR=/tmp/uv-cache
export XDG_CACHE_HOME=/tmp

uv run ruff check .
uv run pytest -q
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 13.03s:
All checks passed!
........................................................................ [ 51%]
.....................................................................    [100%]
141 passed in 12.55s
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+


thinking
**Preparing for commit**

I need to finalize my changes with the message `Parity: V1P-0010 daily generate`. My next step is to run `git status` to see what's altered. It's crucial that I haven't touched any orchestrator-owned files, as I've only modified the `src` and `tests` directories. There are logs, but I shouldn't commit them. I'll check if `.gitignore` is set up to ignore those and proceed with the necessary commands. Let's get this done!
Plan update
  ✓ Run legacy daily in temp root
  ✓ Implement CLI parity fixes
  ✓ Run ph daily generate in temp root
  ✓ Diff stdout and generated file
  ✓ Add deterministic pytest coverage
  ✓ Run ruff and pytest
  → Commit changes
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

exec
/bin/zsh -lc 'set -euo pipefail
git status --porcelain
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 85ms:
 M cli_plan/session_logs.md
 M cli_plan/tasks_v1_parity.json
 M src/ph/cli.py
 M src/ph/config.py
 M src/ph/daily.py
 M tests/test_daily.py
?? .codex-agent-V1P-0006.log
?? .codex-agent-V1P-0006.pid
?? .codex-agent-V1P-0007.log
?? .codex-agent-V1P-0007.pid
?? .codex-agent-V1P-0008.log
?? .codex-agent-V1P-0008.pid
?? .codex-agent-V1P-0008.prompt.txt
?? .codex-agent-V1P-0009.log
?? .codex-agent-V1P-0009.pid
?? .codex-agent-V1P-0009.prompt.txt
?? .codex-agent-V1P-0010.log
?? .codex-agent-V1P-0010.pid
?? .codex-agent-V1P-0010.prompt.txt
?? ph-parity-V1P-0002.done
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+



thinking
**Considering git commit options**

I need to explore modifications in files that shouldn’t be touched or committed. `git status` shows them modified, but I can still commit my files by specifying paths, leaving those uncommitted. They’ll remain in the working tree, which could be acceptable. The main point is to avoid editing or committing those files. I’ll only stage and commit relevant files, ensuring to exclude the orchestrator files, and I won’t include logs.
thinking
**Planning the git commit**

I need to make sure I’m not including .codex logs or .done files in my commit since they're untracked. I'll also ensure I don’t commit those orchestrator files. To focus on my changes, I’ll precisely add the necessary files: `git add src/ph/cli.py src/ph/config.py src/ph/daily.py tests/test_daily.py tests/test_daily_make_parity.py`. Once that’s done, I’ll commit with an appropriate message. Alright, let's get this organized!
exec
/bin/zsh -lc 'set -euo pipefail
git add src/ph/cli.py src/ph/config.py src/ph/daily.py tests/test_daily.py tests/test_daily_make_parity.py

git commit -m "Parity: V1P-0010 daily generate"
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli exited 128 in 70ms:
fatal: Unable to create '/Users/spensermcconnell/__Active_Code/project-handbook-cli/.git/index.lock': Operation not permitted
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+


thinking
**Troubleshooting Git issues**

I attempted to use the command for both adding and committing, but it seems like there was a problem with creating the lock file. This indicates that the add action may have failed. The error message suggests no staging was performed. So, the next step would be to check the output of `git status` again to understand the current state of the repository better. Let's see what that reveals!
exec
/bin/zsh -lc 'set -euo pipefail
git status --porcelain
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 78ms:
 M cli_plan/session_logs.md
 M cli_plan/tasks_v1_parity.json
 M src/ph/cli.py
 M src/ph/config.py
 M src/ph/daily.py
 M tests/test_daily.py
?? .codex-agent-V1P-0006.log
?? .codex-agent-V1P-0006.pid
?? .codex-agent-V1P-0007.log
?? .codex-agent-V1P-0007.pid
?? .codex-agent-V1P-0008.log
?? .codex-agent-V1P-0008.pid
?? .codex-agent-V1P-0008.prompt.txt
?? .codex-agent-V1P-0009.log
?? .codex-agent-V1P-0009.pid
?? .codex-agent-V1P-0009.prompt.txt
?? .codex-agent-V1P-0010.log
?? .codex-agent-V1P-0010.pid
?? .codex-agent-V1P-0010.prompt.txt
?? ph-parity-V1P-0002.done
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

Plan update
All code/test work is complete; git commit attempt failed due to sandbox permissions preventing writes under `.git/` (index.lock).
  ✓ Run legacy daily in temp root
  ✓ Implement CLI parity fixes
  ✓ Run ph daily generate in temp root
  ✓ Diff stdout and generated file
  ✓ Add deterministic pytest coverage
  ✓ Run ruff and pytest
  ✓ Commit changes
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

exec
/bin/zsh -lc 'set -euo pipefail
touch ph-parity-V1P-0010.done
' in /Users/spensermcconnell/__Active_Code/project-handbook-cli succeeded in 60ms:

file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

codex
Commands executed (exact)
- `LEGACY_SRC="/Users/spensermcconnell/__Active_Code/oss-saas/project-handbook"`
- `PH_ROOT_LEGACY="$(mktemp -d -t ph-parity-V1P-0010-legacy-XXXXXXXX)"`
- `PH_ROOT_PH="$(mktemp -d -t ph-parity-V1P-0010-ph-XXXXXXXX)"`
- `rsync -a --delete --exclude '.git' --exclude 'node_modules' --exclude '.venv' --exclude '.project-handbook' "$LEGACY_SRC/" "$PH_ROOT_LEGACY/"`
- `rsync -a --delete --exclude '.git' --exclude 'node_modules' --exclude '.venv' --exclude '.project-handbook' "$LEGACY_SRC/" "$PH_ROOT_PH/"`
- `(cd "$PH_ROOT_LEGACY" && pnpm install --frozen-lockfile)`
- `(cd "$PH_ROOT_PH" && pnpm install --frozen-lockfile)`
- `(cd "$PH_ROOT_LEGACY" && pnpm make -- daily) > /tmp/legacy-daily-stdout.txt`
- `LEGACY_DAILY_FILE=$(ls -1 "$PH_ROOT_LEGACY"/status/daily/*/*/*.md | sort | tail -n 1)`
- `cp "$LEGACY_DAILY_FILE" /tmp/legacy-daily.md`
- `UV_CACHE_DIR=/tmp/uv-cache XDG_CACHE_HOME=/tmp uv run ph --root "$PH_ROOT_PH" daily generate > /tmp/ph-daily-stdout.txt`
- `PH_DAILY_FILE=$(ls -1 "$PH_ROOT_PH"/status/daily/*/*/*.md | sort | tail -n 1)`
- `cp "$PH_DAILY_FILE" /tmp/ph-daily.md`
- `diff -u /tmp/legacy-daily-stdout.txt /tmp/ph-daily-stdout.txt`
- `diff -u /tmp/legacy-daily.md /tmp/ph-daily.md`
- `uv run ruff check .`
- `uv run pytest -q`
- `git status --porcelain`
- `git add src/ph/cli.py src/ph/config.py src/ph/daily.py tests/test_daily.py tests/test_daily_make_parity.py`
- `git commit -m "Parity: V1P-0010 daily generate"` (failed; see below)
- `touch ph-parity-V1P-0010.done`

Files changed (exact)
- `src/ph/cli.py`
- `src/ph/config.py`
- `src/ph/daily.py`
- `tests/test_daily.py`
- `tests/test_daily_make_parity.py`
- `ph-parity-V1P-0010.done` (sentinel)

Verification evidence
- Daily file diff: `diff -u /tmp/legacy-daily.md /tmp/ph-daily.md` => no output (byte-for-byte match).
- Stdout diff: differs only by the absolute temp root path (expected since `PH_ROOT_LEGACY` and `PH_ROOT_PH` are intentionally different).
- Ruff: `All checks passed!`
- Pytest: `141 passed`

Commit
- Blocked by environment permissions: `fatal: Unable to create '/Users/spensermcconnell/__Active_Code/project-handbook-cli/.git/index.lock': Operation not permitted`

Follow-ups / drift
- `diff -u` on stdout will always show temp-root path differences when using separate PH_ROOTs; only the path substrings differ.
- `git status` shows `cli_plan/session_logs.md` and `cli_plan/tasks_v1_parity.json` modified, but I did not stage or commit them (guardrail files).

DONE: V1P-0010 — `ph daily generate` now matches legacy daily file content and legacy-style stdout (aside from temp root path)
file update:
diff --git a/src/ph/cli.py b/src/ph/cli.py
index f3d30c6e5a73819b76153bce89929beaeaabff62..55f930cd66ee29b9516eeb7302471496a5c06644
--- a/src/ph/cli.py
+++ b/src/ph/cli.py
@@ -969,6 +969,7 @@
                     print("Usage: ph daily <generate|check>\n", file=sys.stderr, end="")
                     exit_code = 2
                 elif args.daily_command == "generate":
+                    sys.stdout.write(_format_pnpm_make_preamble(ph_root=ph_root, make_args=["daily"]))
                     created = create_daily_status(
                         ph_root=ph_root,
                         ph_data_root=ctx.ph_data_root,
diff --git a/src/ph/config.py b/src/ph/config.py
index 905407b76fd962bbd28748d0a0a16c6370599237..04043f3f3b72e33be995a64c5e757474de1ee66f
--- a/src/ph/config.py
+++ b/src/ph/config.py
@@ -8,6 +8,9 @@
 
 from . import __version__
 
+DEFAULT_SCHEMA_VERSION = 1
+DEFAULT_REQUIRES_PH_VERSION = ">=0.1.0,<0.2.0"
+
 
 @dataclass(frozen=True)
 class HandbookConfig:
@@ -47,7 +50,14 @@
         raise ConfigError(_config_error_message(f"Missing config: {config_paths[0]}"))
 
     handbook_schema_version = raw.get("handbook_schema_version")
+    if isinstance(handbook_schema_version, str) and handbook_schema_version.strip().isdigit():
+        handbook_schema_version = int(handbook_schema_version.strip())
+    if handbook_schema_version is None:
+        handbook_schema_version = DEFAULT_SCHEMA_VERSION
+
     requires_ph_version = raw.get("requires_ph_version")
+    if requires_ph_version is None:
+        requires_ph_version = DEFAULT_REQUIRES_PH_VERSION
     repo_root = raw.get("repo_root")
 
     if not isinstance(handbook_schema_version, int):
@@ -69,8 +79,6 @@
         raise ConfigError(
             _config_error_message(f"Unsupported handbook_schema_version: {config.handbook_schema_version} (expected 1)")
         )
-    if config.repo_root != ".":
-        raise ConfigError(_config_error_message(f"Invalid repo_root: {config.repo_root!r} (expected '.')"))
 
     try:
         spec = SpecifierSet(config.requires_ph_version)
diff --git a/src/ph/daily.py b/src/ph/daily.py
index 73feabaf03c9079a9799408df722bd779c761d1a..17387eba7d67e0b808baedc3db956521b42077a7
--- a/src/ph/daily.py
+++ b/src/ph/daily.py
@@ -161,8 +161,10 @@
     tasks = collect_sprint_tasks(ph_data_root=ph_data_root, env=env)
 
     paths = daily_paths_for_date(ph_data_root=ph_data_root, date=date)
-    sprint_plan = ph_data_root / "sprints" / "current" / "plan.md"
-    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent, target=sprint_plan)
+    sprint_plan = ph_data_root / "sprints" / "current.md"
+    # Legacy `make daily` computes the link as if it were relative to the year directory
+    # (status/daily/YYYY), even though the file is written under status/daily/YYYY/MM.
+    sprint_plan_rel = relative_markdown_link(from_dir=paths.status_file.parent.parent, target=sprint_plan)
 
     weekday = date.weekday()
     is_monday = weekday == 0
diff --git a/tests/test_daily.py b/tests/test_daily.py
index 09ffc070af23c2a6a3723bee816dc5da0a69d319..94d873585c57d937b85f18ad7762f6a5d41ea2d5
--- a/tests/test_daily.py
+++ b/tests/test_daily.py
@@ -24,8 +24,9 @@
     (ph_root / "process" / "automation" / "reset_spec.json").write_text("{}", encoding="utf-8")
 
 def _expected_sprint_plan_link(*, scope_root: Path, daily_file: Path) -> str:
-    target = scope_root / "sprints" / "current" / "plan.md"
-    return os.path.relpath(str(target), str(daily_file.parent)).replace(os.sep, "/")
+    target = scope_root / "sprints" / "current.md"
+    year_dir = daily_file.parent.parent
+    return os.path.relpath(str(target), str(year_dir)).replace(os.sep, "/")
 
 
 def test_daily_generate_skips_weekends_unless_forced(tmp_path: Path) -> None:
diff --git a/tests/test_daily_make_parity.py b/tests/test_daily_make_parity.py
new file mode 100644
index 0000000000000000000000000000000000000000..289583e37a00a29a3615c4cf0b4d6e7a1e0e7eee
--- /dev/null
+++ b/tests/test_daily_make_parity.py
@@ -0,0 +1,130 @@
+from __future__ import annotations
+
+import os
+import subprocess
+from pathlib import Path
+
+
+def _write_legacy_like_config(ph_root: Path) -> None:
+    # Legacy handbook repos may have only repo_root (and it may be absolute).
+    (ph_root / "project_handbook.config.json").write_text(
+        '{\n  "repo_root": "/tmp"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_legacy_like_package_json(ph_root: Path) -> None:
+    (ph_root / "package.json").write_text(
+        '{\n  "name": "project-handbook",\n  "version": "0.0.0"\n}\n',
+        encoding="utf-8",
+    )
+
+
+def _write_sprint_with_done_tasks(ph_root: Path) -> None:
+    sprint_dir = ph_root / "sprints" / "SEQ" / "SPRINT-SEQ-0004"
+    tasks_dir = sprint_dir / "tasks"
+    tasks_dir.mkdir(parents=True, exist_ok=True)
+
+    # 10 done tasks totaling 28 points.
+    points = [3, 3, 3, 3, 3, 3, 3, 3, 2, 2]
+    for i, pts in enumerate(points, start=1):
+        task_id = f"TASK-{i:03d}"
+        task_dir = tasks_dir / f"{task_id}-example"
+        task_dir.mkdir(parents=True, exist_ok=True)
+        (task_dir / "task.yaml").write_text(
+            "\n".join(
+                [
+                    f"id: {task_id}",
+                    f"title: Example {task_id}",
+                    "status: done",
+                    f"story_points: {pts}",
+                    "",
+                ]
+            ),
+            encoding="utf-8",
+        )
+
+    current_link = ph_root / "sprints" / "current"
+    current_link.parent.mkdir(parents=True, exist_ok=True)
+    current_link.symlink_to(sprint_dir)
+
+
+def _write_backlog_index(ph_root: Path) -> None:
+    backlog = ph_root / "backlog"
+    backlog.mkdir(parents=True, exist_ok=True)
+    (backlog / "index.json").write_text(
+        '{\n  "items": [\n    {"severity": "P1"},\n    {"severity": "P1"}\n  ]\n}\n',
+        encoding="utf-8",
+    )
+
+
+def test_daily_generate_stdout_and_file_match_make_daily(tmp_path: Path) -> None:
+    _write_legacy_like_config(tmp_path)
+    _write_legacy_like_package_json(tmp_path)
+    _write_sprint_with_done_tasks(tmp_path)
+    _write_backlog_index(tmp_path)
+
+    env = dict(os.environ)
+    env["PH_FAKE_TODAY"] = "2026-02-04"
+
+    result = subprocess.run(
+        ["ph", "--root", str(tmp_path), "--no-post-hook", "daily", "generate"],
+        capture_output=True,
+        text=True,
+        env=env,
+    )
+    assert result.returncode == 0
+
+    resolved = tmp_path.resolve()
+    expected_stdout = (
+        "\n"
+        f"> project-handbook@0.0.0 make {resolved}\n"
+        "> make -- daily\n"
+        "\n"
+        f"Created daily status: {resolved}/status/daily/2026/02/04.md\n"
+    )
+    assert result.stdout == expected_stdout
+
+    out_path = tmp_path / "status" / "daily" / "2026" / "02" / "04.md"
+    assert out_path.exists()
+    assert out_path.read_text(encoding="utf-8") == (
+        "---\n"
+        "title: Daily Status - 2026-02-04\n"
+        "type: status-daily\n"
+        "date: 2026-02-04\n"
+        "sprint: SPRINT-SEQ-0004\n"
+        "tags: [status, daily]\n"
+        "links: [../../../sprints/current.md]\n"
+        "---\n"
+        "\n"
+        "# Daily Status - Wednesday, February 04, 2026\n"
+        "\n"
+        "## Sprint: SPRINT-SEQ-0004\n"
+        "**Weekday**: Wednesday (daily status is date-based; sprint planning may be bounded)\n"
+        "\n"
+        "## Progress\n"
+        "- [ ] No tasks currently in progress\n"
+        "\n"
+        "## Completed Today\n"
+        "- [ ] (Update with completed tasks)\n"
+        "\n"
+        "## Blockers\n"
+        "- None\n"
+        "\n"
+        "## Backlog Impact\n"
+        "- P1 Issues: 2 high priority for next sprint\n"
+        "- New issues discovered: (Update if any)\n"
+        "\n"
+        "## Decisions\n"
+        "- (Document any technical decisions made today)\n"
+        "\n"
+        "## Next Focus\n"
+        "- Continue current work\n"
+        "\n"
+        "## Sprint Telemetry\n"
+        "- Total Points: 28\n"
+        "- Completed: 28\n"
+        "- In Progress: 0\n"
+        "- Velocity: 28/28 (100%)\n"
+    )
+

tokens used
182,350
Commands executed (exact)
- `LEGACY_SRC="/Users/spensermcconnell/__Active_Code/oss-saas/project-handbook"`
- `PH_ROOT_LEGACY="$(mktemp -d -t ph-parity-V1P-0010-legacy-XXXXXXXX)"`
- `PH_ROOT_PH="$(mktemp -d -t ph-parity-V1P-0010-ph-XXXXXXXX)"`
- `rsync -a --delete --exclude '.git' --exclude 'node_modules' --exclude '.venv' --exclude '.project-handbook' "$LEGACY_SRC/" "$PH_ROOT_LEGACY/"`
- `rsync -a --delete --exclude '.git' --exclude 'node_modules' --exclude '.venv' --exclude '.project-handbook' "$LEGACY_SRC/" "$PH_ROOT_PH/"`
- `(cd "$PH_ROOT_LEGACY" && pnpm install --frozen-lockfile)`
- `(cd "$PH_ROOT_PH" && pnpm install --frozen-lockfile)`
- `(cd "$PH_ROOT_LEGACY" && pnpm make -- daily) > /tmp/legacy-daily-stdout.txt`
- `LEGACY_DAILY_FILE=$(ls -1 "$PH_ROOT_LEGACY"/status/daily/*/*/*.md | sort | tail -n 1)`
- `cp "$LEGACY_DAILY_FILE" /tmp/legacy-daily.md`
- `UV_CACHE_DIR=/tmp/uv-cache XDG_CACHE_HOME=/tmp uv run ph --root "$PH_ROOT_PH" daily generate > /tmp/ph-daily-stdout.txt`
- `PH_DAILY_FILE=$(ls -1 "$PH_ROOT_PH"/status/daily/*/*/*.md | sort | tail -n 1)`
- `cp "$PH_DAILY_FILE" /tmp/ph-daily.md`
- `diff -u /tmp/legacy-daily-stdout.txt /tmp/ph-daily-stdout.txt`
- `diff -u /tmp/legacy-daily.md /tmp/ph-daily.md`
- `uv run ruff check .`
- `uv run pytest -q`
- `git status --porcelain`
- `git add src/ph/cli.py src/ph/config.py src/ph/daily.py tests/test_daily.py tests/test_daily_make_parity.py`
- `git commit -m "Parity: V1P-0010 daily generate"` (failed; see below)
- `touch ph-parity-V1P-0010.done`

Files changed (exact)
- `src/ph/cli.py`
- `src/ph/config.py`
- `src/ph/daily.py`
- `tests/test_daily.py`
- `tests/test_daily_make_parity.py`
- `ph-parity-V1P-0010.done` (sentinel)

Verification evidence
- Daily file diff: `diff -u /tmp/legacy-daily.md /tmp/ph-daily.md` => no output (byte-for-byte match).
- Stdout diff: differs only by the absolute temp root path (expected since `PH_ROOT_LEGACY` and `PH_ROOT_PH` are intentionally different).
- Ruff: `All checks passed!`
- Pytest: `141 passed`

Commit
- Blocked by environment permissions: `fatal: Unable to create '/Users/spensermcconnell/__Active_Code/project-handbook-cli/.git/index.lock': Operation not permitted`

Follow-ups / drift
- `diff -u` on stdout will always show temp-root path differences when using separate PH_ROOTs; only the path substrings differ.
- `git status` shows `cli_plan/session_logs.md` and `cli_plan/tasks_v1_parity.json` modified, but I did not stage or commit them (guardrail files).

DONE: V1P-0010 — `ph daily generate` now matches legacy daily file content and legacy-style stdout (aside from temp root path)
